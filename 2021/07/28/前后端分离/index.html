<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="John Doe"><meta name="copyright" content="John Doe"><meta name="generator" content="Hexo 5.4.0"><meta name="theme" content="hexo-theme-yun"><title>Hexo</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.25/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_dxory92pb0h.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>document.addEventListener("DOMContentLoaded", () => {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
});
</script><link rel="icon" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#0078E7"><link rel="alternate icon" href="/yun.ico"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"example.com","root":"/","title":"é€é¥ä¸€å°ç”Ÿ","version":"1.6.1","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}.","hits":"${hits} results found","hits_time":"${hits} results found in ${time} ms"},"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"https://v1.hitokoto.cn","hitokoto":true},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/utils.js"></script><script src="/js/hexo-theme-yun.js"></script><meta name="description" content="å‰åç«¯åˆ†ç¦»é¡¹ç›®æ–‡ç« æ€»ä½“åˆ†ä¸º2å¤§éƒ¨åˆ†ï¼ŒJavaåç«¯æ¥å£å’Œvueå‰ç«¯é¡µé¢ï¼Œæ¯”è¾ƒé•¿ï¼Œå› ä¸ºä¸æƒ³åˆ†å¼€å‘å¸ƒ å…ˆçœ‹æ•ˆæœï¼š   ä¸å¤šè¯´ï¼Œå¼€å§‹æ•²ä»£ç ã€‚ Javaåç«¯æ¥å£å¼€å‘1ã€å‰è¨€ä»é›¶å¼€å§‹æ­å»ºä¸€ä¸ªé¡¹ç›®éª¨æ¶ï¼Œæœ€å¥½é€‰æ‹©åˆé€‚ï¼Œç†Ÿæ‚‰çš„æŠ€æœ¯ï¼Œå¹¶ä¸”åœ¨æœªæ¥æ˜“æ‹“å±•ï¼Œé€‚åˆå¾®æœåŠ¡åŒ–ä½“ç³»ç­‰ã€‚æ‰€ä»¥ä¸€èˆ¬ä»¥Springbootä½œä¸ºæˆ‘ä»¬çš„æ¡†æ¶åŸºç¡€ï¼Œè¿™æ˜¯ç¦»ä¸å¼€çš„äº†ã€‚ ç„¶åæ•°æ®å±‚ï¼Œæˆ‘ä»¬å¸¸ç”¨çš„æ˜¯Mybatisï¼Œæ˜“ä¸Šæ‰‹ï¼Œæ–¹ä¾¿ç»´æŠ¤ã€‚ä½†æ˜¯å•è¡¨æ“ä½œæ¯”è¾ƒå›°éš¾ï¼Œ">
<meta property="og:type" content="article">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/2021/07/28/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="å‰åç«¯åˆ†ç¦»é¡¹ç›®æ–‡ç« æ€»ä½“åˆ†ä¸º2å¤§éƒ¨åˆ†ï¼ŒJavaåç«¯æ¥å£å’Œvueå‰ç«¯é¡µé¢ï¼Œæ¯”è¾ƒé•¿ï¼Œå› ä¸ºä¸æƒ³åˆ†å¼€å‘å¸ƒ å…ˆçœ‹æ•ˆæœï¼š   ä¸å¤šè¯´ï¼Œå¼€å§‹æ•²ä»£ç ã€‚ Javaåç«¯æ¥å£å¼€å‘1ã€å‰è¨€ä»é›¶å¼€å§‹æ­å»ºä¸€ä¸ªé¡¹ç›®éª¨æ¶ï¼Œæœ€å¥½é€‰æ‹©åˆé€‚ï¼Œç†Ÿæ‚‰çš„æŠ€æœ¯ï¼Œå¹¶ä¸”åœ¨æœªæ¥æ˜“æ‹“å±•ï¼Œé€‚åˆå¾®æœåŠ¡åŒ–ä½“ç³»ç­‰ã€‚æ‰€ä»¥ä¸€èˆ¬ä»¥Springbootä½œä¸ºæˆ‘ä»¬çš„æ¡†æ¶åŸºç¡€ï¼Œè¿™æ˜¯ç¦»ä¸å¼€çš„äº†ã€‚ ç„¶åæ•°æ®å±‚ï¼Œæˆ‘ä»¬å¸¸ç”¨çš„æ˜¯Mybatisï¼Œæ˜“ä¸Šæ‰‹ï¼Œæ–¹ä¾¿ç»´æŠ¤ã€‚ä½†æ˜¯å•è¡¨æ“ä½œæ¯”è¾ƒå›°éš¾ï¼Œ">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/2021/07/28/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae9185aabf1">
<meta property="og:image" content="http://example.com/2021/07/28/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae928eab37d">
<meta property="og:image" content="http://example.com/2021/07/28/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae9185fa3e2">
<meta property="og:image" content="http://example.com/2021/07/28/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae91837ec77">
<meta property="og:image" content="http://example.com/2021/07/28/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae923568c9c">
<meta property="og:image" content="http://example.com/2021/07/28/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae9524d355a">
<meta property="og:image" content="http://example.com/2021/07/28/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae94b89988f">
<meta property="og:image" content="http://example.com/2021/07/28/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae95678ee6a">
<meta property="og:image" content="http://example.com/2021/07/28/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae952468938">
<meta property="og:image" content="http://example.com/2021/07/28/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae9568052ba">
<meta property="og:image" content="http://example.com/2021/07/28/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae961d9cee9">
<meta property="og:image" content="http://example.com/2021/07/28/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae97fe547a2">
<meta property="og:image" content="http://example.com/2021/07/28/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae9801251e0">
<meta property="og:image" content="http://example.com/2021/07/28/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae9870770cb">
<meta property="og:image" content="http://example.com/2021/07/28/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae9988c77fc">
<meta property="og:image" content="http://example.com/2021/07/28/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae9934c09b7">
<meta property="og:image" content="http://example.com/2021/07/28/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae9b6f2f82a">
<meta property="og:image" content="http://example.com/2021/07/28/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae9c0da7a02">
<meta property="og:image" content="http://example.com/2021/07/28/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae9c4c440a3">
<meta property="og:image" content="http://example.com/2021/07/28/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae9cb783513">
<meta property="og:image" content="http://example.com/2021/07/28/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae9d7e97e21">
<meta property="article:published_time" content="2021-07-28T03:34:12.995Z">
<meta property="article:modified_time" content="2020-06-18T06:46:31.000Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2021/07/28/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae9185aabf1"><script src="/js/ui/mode.js"></script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="Table of Contents"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="Overview"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info mickey-mouse"><a class="site-author-avatar" href="/about/" title="John Doe"><img width="96" loading="lazy" src="/img/1.jpg" alt="John Doe"><span class="site-author-status" title="ä¸€ç‚¹æµ©ç„¶æ°”ï¼Œåƒé‡Œå¿«å“‰é£ï¼">ğŸ˜Š</span></a><div class="site-author-name"><a href="/about/">John Doe</a></div><span class="site-name">Hexo</span><sub class="site-subtitle"></sub><div class="site-desciption"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="Home"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="Archives"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">22</span></a></div><div class="site-state-item"><a href="/categories/" title="Categories"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">0</span></a></div><div class="site-state-item"><a href="/tags/" title="Tags"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">0</span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://yun.yunyoujun.cn" title="æ–‡æ¡£"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-settings-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="/atom.xml" title="RSS" target="_blank" style="color:orange"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-rss-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://qm.qq.com/cgi-bin/qm/qr?k=kZJzggTTCf4SpvEQ8lXWoi5ZjhAx0ILZ&amp;jump_from=webapi" title="QQ  2038527170" target="_blank" style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/qas15782/" title="GitHub" target="_blank" style="color:#6e5494"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://weibo.com/" title="å¾®åš" target="_blank" style="color:#E6162D"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-weibo-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.douban.com/" title="è±†ç“£" target="_blank" style="color:#007722"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-douban-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://music.163.com/#/user/home?id=1659649930" title="ç½‘æ˜“äº‘éŸ³ä¹" target="_blank" style="color:#C20C0C"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-netease-cloud-music-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.zhihu.com/people/" title="çŸ¥ä¹" target="_blank" style="color:#0084FF"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-zhihu-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://space.bilibili.com/472753721" title="å“”å“©å“”å“©" target="_blank" style="color:#FF8EB3"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-bilibili-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://cdn.jsdelivr.net" title="å¾®ä¿¡å…¬ä¼—å·" target="_blank" style="color:#1AAD19"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-2-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://twitter.com/" title="Twitter" target="_blank" style="color:#1da1f2"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-twitter-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://baidu.com" title="Telegram Channel" target="_blank" style="color:#0088CC"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-telegram-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="2038527170@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://travellings.link" title="Travelling" target="_blank" style="color:var(--hty-text-color)"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-train-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="æˆ‘çš„å°ä¼™ä¼´ä»¬" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E9%A1%B9%E7%9B%AE"><span class="toc-number">1.</span> <span class="toc-text">å‰åç«¯åˆ†ç¦»é¡¹ç›®</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Java%E5%90%8E%E7%AB%AF%E6%8E%A5%E5%8F%A3%E5%BC%80%E5%8F%91"><span class="toc-number">2.</span> <span class="toc-text">Javaåç«¯æ¥å£å¼€å‘</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E5%89%8D%E8%A8%80"><span class="toc-number">2.1.</span> <span class="toc-text">1ã€å‰è¨€</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E6%96%B0%E5%BB%BASpringboot%E9%A1%B9%E7%9B%AE"><span class="toc-number">2.2.</span> <span class="toc-text">2ã€æ–°å»ºSpringbooté¡¹ç›®</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E6%95%B4%E5%90%88mybatis-plus"><span class="toc-number">2.3.</span> <span class="toc-text">3ã€æ•´åˆmybatis plus</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E7%BB%9F%E4%B8%80%E7%BB%93%E6%9E%9C%E5%B0%81%E8%A3%85"><span class="toc-number">2.4.</span> <span class="toc-text">3ã€ç»Ÿä¸€ç»“æœå°è£…</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E6%95%B4%E5%90%88shiro-jwt%EF%BC%8C%E5%B9%B6%E4%BC%9A%E8%AF%9D%E5%85%B1%E4%BA%AB"><span class="toc-number">2.5.</span> <span class="toc-text">4ã€æ•´åˆshiro+jwtï¼Œå¹¶ä¼šè¯å…±äº«</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ShiroConfig"><span class="toc-number">2.5.1.</span> <span class="toc-text">ShiroConfig</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#AccountRealm"><span class="toc-number">2.5.2.</span> <span class="toc-text">AccountRealm</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#JwtToken"><span class="toc-number">2.5.3.</span> <span class="toc-text">JwtToken</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#AccountProfile"><span class="toc-number">2.5.4.</span> <span class="toc-text">AccountProfile</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#JwtFilter"><span class="toc-number">2.5.5.</span> <span class="toc-text">JwtFilter</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%81%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86"><span class="toc-number">2.6.</span> <span class="toc-text">5ã€å¼‚å¸¸å¤„ç†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6%E3%80%81%E5%AE%9E%E4%BD%93%E6%A0%A1%E9%AA%8C"><span class="toc-number">2.7.</span> <span class="toc-text">6ã€å®ä½“æ ¡éªŒ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7%E3%80%81%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98"><span class="toc-number">2.8.</span> <span class="toc-text">7ã€è·¨åŸŸé—®é¢˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8%E3%80%81%E7%99%BB%E5%BD%95%E6%8E%A5%E5%8F%A3%E5%BC%80%E5%8F%91"><span class="toc-number">2.9.</span> <span class="toc-text">8ã€ç™»å½•æ¥å£å¼€å‘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9%E3%80%81%E5%8D%9A%E5%AE%A2%E6%8E%A5%E5%8F%A3%E5%BC%80%E5%8F%91"><span class="toc-number">2.10.</span> <span class="toc-text">9ã€åšå®¢æ¥å£å¼€å‘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10%E3%80%81%E5%90%8E%E7%AB%AF%E6%80%BB%E7%BB%93"><span class="toc-number">2.11.</span> <span class="toc-text">10ã€åç«¯æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vue%E5%89%8D%E7%AB%AF%E9%A1%B5%E9%9D%A2%E5%BC%80%E5%8F%91"><span class="toc-number">3.</span> <span class="toc-text">Vueå‰ç«¯é¡µé¢å¼€å‘</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E5%89%8D%E8%A8%80-1"><span class="toc-number">3.1.</span> <span class="toc-text">1ã€å‰è¨€</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E9%A1%B9%E7%9B%AE%E6%BC%94%E7%A4%BA"><span class="toc-number">3.2.</span> <span class="toc-text">2ã€é¡¹ç›®æ¼”ç¤º</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87"><span class="toc-number">3.3.</span> <span class="toc-text">3ã€ç¯å¢ƒå‡†å¤‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E6%96%B0%E5%BB%BA%E9%A1%B9%E7%9B%AE"><span class="toc-number">3.4.</span> <span class="toc-text">4ã€æ–°å»ºé¡¹ç›®</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%81%E5%AE%89%E8%A3%85element-ui"><span class="toc-number">3.5.</span> <span class="toc-text">5ã€å®‰è£…element-ui</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6%E3%80%81%E5%AE%89%E8%A3%85axios"><span class="toc-number">3.6.</span> <span class="toc-text">6ã€å®‰è£…axios</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7%E3%80%81%E9%A1%B5%E9%9D%A2%E8%B7%AF%E7%94%B1"><span class="toc-number">3.7.</span> <span class="toc-text">7ã€é¡µé¢è·¯ç”±</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8%E3%80%81%E7%99%BB%E5%BD%95%E9%A1%B5%E9%9D%A2"><span class="toc-number">3.8.</span> <span class="toc-text">8ã€ç™»å½•é¡µé¢</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#token%E7%9A%84%E7%8A%B6%E6%80%81%E5%90%8C%E6%AD%A5"><span class="toc-number">3.8.1.</span> <span class="toc-text">tokençš„çŠ¶æ€åŒæ­¥</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E5%85%A8%E5%B1%80axios%E6%8B%A6%E6%88%AA%E5%99%A8"><span class="toc-number">3.8.2.</span> <span class="toc-text">å®šä¹‰å…¨å±€axiosæ‹¦æˆªå™¨</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9%E3%80%81%E5%8D%9A%E5%AE%A2%E5%88%97%E8%A1%A8"><span class="toc-number">3.9.</span> <span class="toc-text">9ã€åšå®¢åˆ—è¡¨</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%B4%E9%83%A8%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF"><span class="toc-number">3.9.1.</span> <span class="toc-text">å¤´éƒ¨ç”¨æˆ·ä¿¡æ¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%9A%E5%AE%A2%E5%88%86%E9%A1%B5"><span class="toc-number">3.9.2.</span> <span class="toc-text">åšå®¢åˆ†é¡µ</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10%E3%80%81%E5%8D%9A%E5%AE%A2%E7%BC%96%E8%BE%91%EF%BC%88%E5%8F%91%E8%A1%A8%EF%BC%89"><span class="toc-number">3.10.</span> <span class="toc-text">10ã€åšå®¢ç¼–è¾‘ï¼ˆå‘è¡¨ï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E8%A3%85mavon-editor"><span class="toc-number">3.10.1.</span> <span class="toc-text">å®‰è£…mavon-editor</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11%E3%80%81%E5%8D%9A%E5%AE%A2%E8%AF%A6%E6%83%85"><span class="toc-number">3.11.</span> <span class="toc-text">11ã€åšå®¢è¯¦æƒ…</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12%E3%80%81%E8%B7%AF%E7%94%B1%E6%9D%83%E9%99%90%E6%8B%A6%E6%88%AA"><span class="toc-number">3.12.</span> <span class="toc-text">12ã€è·¯ç”±æƒé™æ‹¦æˆª</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13%E3%80%81%E5%89%8D%E7%AB%AF%E6%80%BB%E7%BB%93"><span class="toc-number">3.13.</span> <span class="toc-text">13ã€å‰ç«¯æ€»ç»“</span></a></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="http://example.com/2021/07/28/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="John Doe"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="Hexo"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"></h1><div class="post-meta"><div class="post-time" style="display:inline-block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <time title="Created: 2021-07-28 11:34:12" itemprop="dateCreated datePublished" datetime="2021-07-28T11:34:12+08:00">2021-07-28</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-2-line"></use></svg></span> <time title="Modified: 2020-06-18 14:46:31" itemprop="dateModified" datetime="2020-06-18T14:46:31+08:00">2020-06-18</time></div><div class="post-classify"></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#0078E7;"><h2 id="å‰åç«¯åˆ†ç¦»é¡¹ç›®"><a href="#å‰åç«¯åˆ†ç¦»é¡¹ç›®" class="headerlink" title="å‰åç«¯åˆ†ç¦»é¡¹ç›®"></a>å‰åç«¯åˆ†ç¦»é¡¹ç›®</h2><p>æ–‡ç« æ€»ä½“åˆ†ä¸º2å¤§éƒ¨åˆ†ï¼ŒJavaåç«¯æ¥å£å’Œvueå‰ç«¯é¡µé¢ï¼Œæ¯”è¾ƒé•¿ï¼Œå› ä¸ºä¸æƒ³åˆ†å¼€å‘å¸ƒ</p>
<p>å…ˆçœ‹æ•ˆæœï¼š</p>
<p><img src="%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae9185aabf1" alt="å›¾ç‰‡" loading="lazy"></p>
<p><img src="%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae928eab37d" alt="å›¾ç‰‡" loading="lazy"></p>
<p>ä¸å¤šè¯´ï¼Œå¼€å§‹æ•²ä»£ç ã€‚</p>
<h2 id="Javaåç«¯æ¥å£å¼€å‘"><a href="#Javaåç«¯æ¥å£å¼€å‘" class="headerlink" title="Javaåç«¯æ¥å£å¼€å‘"></a>Javaåç«¯æ¥å£å¼€å‘</h2><h3 id="1ã€å‰è¨€"><a href="#1ã€å‰è¨€" class="headerlink" title="1ã€å‰è¨€"></a>1ã€å‰è¨€</h3><p>ä»é›¶å¼€å§‹æ­å»ºä¸€ä¸ªé¡¹ç›®éª¨æ¶ï¼Œæœ€å¥½é€‰æ‹©åˆé€‚ï¼Œç†Ÿæ‚‰çš„æŠ€æœ¯ï¼Œå¹¶ä¸”åœ¨æœªæ¥æ˜“æ‹“å±•ï¼Œé€‚åˆå¾®æœåŠ¡åŒ–ä½“ç³»ç­‰ã€‚æ‰€ä»¥ä¸€èˆ¬ä»¥Springbootä½œä¸ºæˆ‘ä»¬çš„æ¡†æ¶åŸºç¡€ï¼Œè¿™æ˜¯ç¦»ä¸å¼€çš„äº†ã€‚</p>
<p>ç„¶åæ•°æ®å±‚ï¼Œæˆ‘ä»¬å¸¸ç”¨çš„æ˜¯Mybatisï¼Œæ˜“ä¸Šæ‰‹ï¼Œæ–¹ä¾¿ç»´æŠ¤ã€‚ä½†æ˜¯å•è¡¨æ“ä½œæ¯”è¾ƒå›°éš¾ï¼Œç‰¹åˆ«æ˜¯æ·»åŠ å­—æ®µæˆ–å‡å°‘å­—æ®µçš„æ—¶å€™ï¼Œæ¯”è¾ƒç¹çï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘æ¨èä½¿ç”¨Mybatis Plusï¼ˆ<a target="_blank" rel="noopener" href="https://mp.baomidou.com/%EF%BC%89%EF%BC%8C%E4%B8%BA%E7%AE%80%E5%8C%96%E5%BC%80%E5%8F%91%E8%80%8C%E7%94%9F%EF%BC%8C%E5%8F%AA%E9%9C%80%E7%AE%80%E5%8D%95%E9%85%8D%E7%BD%AE%EF%BC%8C%E5%8D%B3%E5%8F%AF%E5%BF%AB%E9%80%9F%E8%BF%9B%E8%A1%8C">mp.baomidou.com/ï¼‰ï¼Œä¸ºç®€åŒ–å¼€å‘è€Œç”Ÿï¼Œåªâ€¦</a> CRUD æ“ä½œï¼Œä»è€ŒèŠ‚çœå¤§é‡æ—¶é—´ã€‚</p>
<p>ä½œä¸ºä¸€ä¸ªé¡¹ç›®éª¨æ¶ï¼Œæƒé™ä¹Ÿæ˜¯æˆ‘ä»¬ä¸èƒ½å¿½ç•¥çš„ï¼ŒShiroé…ç½®ç®€å•ï¼Œä½¿ç”¨ä¹Ÿç®€å•ï¼Œæ‰€ä»¥ä½¿ç”¨Shiroä½œä¸ºæˆ‘ä»¬çš„çš„æƒé™ã€‚</p>
<p>è€ƒè™‘åˆ°é¡¹ç›®å¯èƒ½éœ€è¦éƒ¨ç½²å¤šå°ï¼Œè¿™æ—¶å€™æˆ‘ä»¬çš„ä¼šè¯ç­‰ä¿¡æ¯éœ€è¦å…±äº«ï¼ŒRedisæ˜¯ç°åœ¨ä¸»æµçš„ç¼“å­˜ä¸­é—´ä»¶ï¼Œä¹Ÿé€‚åˆæˆ‘ä»¬çš„é¡¹ç›®ã€‚</p>
<p>ç„¶åå› ä¸ºå‰åç«¯åˆ†ç¦»ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨jwtä½œä¸ºæˆ‘ä»¬ç”¨æˆ·èº«ä»½å‡­è¯ã€‚</p>
<p>okï¼Œæˆ‘ä»¬ç°åœ¨å°±å¼€å§‹æ­å»ºæˆ‘ä»¬çš„é¡¹ç›®è„šæ‰‹æ¶ï¼</p>
<p>æŠ€æœ¯æ ˆï¼š</p>
<ul>
<li>SpringBoot</li>
<li>mybatis plus</li>
<li>shiro</li>
<li>lombok</li>
<li>redis</li>
<li>hibernate validatior</li>
<li>jwt</li>
</ul>
<p>å¯¼å›¾ï¼š<a target="_blank" rel="noopener" href="https://www.markerhub.com/map/131">www.markerhub.com/map/131</a></p>
<h3 id="2ã€æ–°å»ºSpringbooté¡¹ç›®"><a href="#2ã€æ–°å»ºSpringbooté¡¹ç›®" class="headerlink" title="2ã€æ–°å»ºSpringbooté¡¹ç›®"></a>2ã€æ–°å»ºSpringbooté¡¹ç›®</h3><p>è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨IDEAæ¥å¼€å‘æˆ‘ä»¬é¡¹ç›®ï¼Œæ–°å»ºæ­¥éª¤æ¯”è¾ƒç®€å•ï¼Œæˆ‘ä»¬å°±ä¸æˆªå›¾äº†ã€‚</p>
<p>å¼€å‘å·¥å…·ä¸ç¯å¢ƒï¼š</p>
<ul>
<li>idea</li>
<li>mysql</li>
<li>jdk 8</li>
<li>maven3.3.9</li>
</ul>
<p>æ–°å»ºå¥½çš„é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼ŒSpringBootç‰ˆæœ¬ä½¿ç”¨çš„ç›®å‰æœ€æ–°çš„2.2.6.RELEASEç‰ˆæœ¬</p>
<p><img src="%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae9185fa3e2" alt="å›¾ç‰‡" loading="lazy"></p>
<p>pomçš„jaråŒ…å¯¼å…¥å¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>devtoolsï¼šé¡¹ç›®çš„çƒ­åŠ è½½é‡å¯æ’ä»¶</li>
<li>lombokï¼šç®€åŒ–ä»£ç çš„å·¥å…·</li>
</ul>
<h3 id="3ã€æ•´åˆmybatis-plus"><a href="#3ã€æ•´åˆmybatis-plus" class="headerlink" title="3ã€æ•´åˆmybatis plus"></a>3ã€æ•´åˆmybatis plus</h3><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥æ•´åˆmybatis plusï¼Œè®©é¡¹ç›®èƒ½å®ŒæˆåŸºæœ¬çš„å¢åˆ æ”¹æŸ¥æ“ä½œã€‚æ­¥éª¤å¾ˆç®€å•ï¼šå¯ä»¥å»å®˜ç½‘çœ‹çœ‹ï¼š<a target="_blank" rel="noopener" href="https://mp.baomidou.com/guide/install.html">mp.baomidou.com/guide/instaâ€¦</a></p>
<p><strong>ç¬¬ä¸€æ­¥ï¼šå¯¼å…¥jaråŒ…</strong></p>
<p>pomä¸­å¯¼å…¥mybatis plusçš„jaråŒ…ï¼Œå› ä¸ºåé¢ä¼šæ¶‰åŠåˆ°ä»£ç ç”Ÿæˆï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦å¯¼å…¥é¡µé¢æ¨¡æ¿å¼•æ“ï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨çš„æ˜¯freemarkerã€‚</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--mp--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-freemarker<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--mpä»£ç ç”Ÿæˆå™¨--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-generator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>ç¬¬äºŒæ­¥ï¼šç„¶åå»å†™é…ç½®æ–‡ä»¶</strong></p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># DataSource Config</span></span><br><span class="line"><span class="attr">spring</span>:<span class="string"></span></span><br><span class="line">  <span class="attr">datasource</span>:<span class="string"></span></span><br><span class="line">    <span class="meta">driver-class-name</span>: <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">url</span>: <span class="string">jdbc:mysql://localhost:3306/vueblog?useUnicode=true&amp;useSSL=false&amp;characterEncoding=utf8&amp;serverTimezone=Asia/Shanghai</span></span><br><span class="line">    <span class="attr">username</span>: <span class="string">root</span></span><br><span class="line">    <span class="attr">password</span>: <span class="string">admin</span></span><br><span class="line"><span class="meta">mybatis-plus</span>:<span class="string"></span></span><br><span class="line">  <span class="meta">mapper-locations</span>: <span class="string">classpath*:/mapper/**Mapper.xml</span></span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢é™¤äº†é…ç½®æ•°æ®åº“çš„ä¿¡æ¯ï¼Œè¿˜é…ç½®äº†myabtis plusçš„mapperçš„xmlæ–‡ä»¶çš„æ‰«æè·¯å¾„ï¼Œè¿™ä¸€æ­¥ä¸è¦å¿˜è®°äº†ã€‚ <strong>ç¬¬ä¸‰æ­¥ï¼šå¼€å¯mapperæ¥å£æ‰«æï¼Œæ·»åŠ åˆ†é¡µæ’ä»¶</strong></p>
<p>æ–°å»ºä¸€ä¸ªåŒ…ï¼šé€šè¿‡@mapperScanæ³¨è§£æŒ‡å®šè¦å˜æˆå®ç°ç±»çš„æ¥å£æ‰€åœ¨çš„åŒ…ï¼Œç„¶ååŒ…ä¸‹é¢çš„æ‰€æœ‰æ¥å£åœ¨ç¼–è¯‘ä¹‹åéƒ½ä¼šç”Ÿæˆç›¸åº”çš„å®ç°ç±»ã€‚PaginationInterceptoræ˜¯ä¸€ä¸ªåˆ†é¡µæ’ä»¶ã€‚</p>
<ul>
<li>com.markerhub.config.MybatisPlusConfig</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableTransactionManagement</span></span><br><span class="line"><span class="meta">@MapperScan(&quot;com.markerhub.mapper&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisPlusConfig</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> PaginationInterceptor <span class="title">paginationInterceptor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        PaginationInterceptor paginationInterceptor = <span class="keyword">new</span> PaginationInterceptor();</span><br><span class="line">        <span class="keyword">return</span> paginationInterceptor;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ç¬¬å››æ­¥ï¼šä»£ç ç”Ÿæˆ</strong></p>
<p>å¦‚æœä½ æ²¡å†ç”¨å…¶ä»–æ’ä»¶ï¼Œé‚£ä¹ˆç°åœ¨å°±å·²ç»å¯ä»¥ä½¿ç”¨mybatis plusäº†ï¼Œå®˜æ–¹ç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªä»£ç ç”Ÿæˆå™¨ï¼Œç„¶åæˆ‘å†™ä¸Šè‡ªå·±çš„å‚æ•°ä¹‹åï¼Œå°±å¯ä»¥ç›´æ¥æ ¹æ®æ•°æ®åº“è¡¨ä¿¡æ¯ç”Ÿæˆentityã€serviceã€mapperç­‰æ¥å£å’Œå®ç°ç±»ã€‚</p>
<ul>
<li>com.markerhub.CodeGenerator</li>
</ul>
<p>å› ä¸ºä»£ç æ¯”è¾ƒé•¿ï¼Œå°±ä¸è´´å‡ºæ¥äº†ï¼Œåœ¨ä»£ç ä»“åº“ä¸Šçœ‹å“ˆï¼</p>
<p>é¦–å…ˆæˆ‘åœ¨æ•°æ®åº“ä¸­æ–°å»ºäº†ä¸€ä¸ªuserè¡¨ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `m_user` (</span><br><span class="line">  `id` <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `username` <span class="type">varchar</span>(<span class="number">64</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `avatar` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `email` <span class="type">varchar</span>(<span class="number">64</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `password` <span class="type">varchar</span>(<span class="number">64</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `status` <span class="type">int</span>(<span class="number">5</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `created` datetime <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `last_login` datetime <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">  KEY `UK_USERNAME` (`username`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `m_blog` (</span><br><span class="line">  `id` <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `user_id` <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `title` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `description` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `content` longtext,</span><br><span class="line">  `created` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">ON</span> UPDATE <span class="built_in">CURRENT_TIMESTAMP</span>,</span><br><span class="line">  `status` tinyint(<span class="number">4</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">11</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4;</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `vueblog`.`m_user` (`id`, `username`, `avatar`, `email`, `password`, `status`, `created`, `last_login`) <span class="keyword">VALUES</span> (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;markerhub&#x27;</span>, <span class="string">&#x27;https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/5a9f48118166308daba8b6da7e466aab.jpg&#x27;</span>, <span class="keyword">NULL</span>, <span class="string">&#x27;96e79218965eb72c92a549dd5a330112&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;2020-04-20 10:44:01&#x27;</span>, <span class="keyword">NULL</span>);</span><br></pre></td></tr></table></figure>

<p>è¿è¡ŒCodeGeneratorçš„mainæ–¹æ³•ï¼Œè¾“å…¥è¡¨åï¼šm_userï¼Œç”Ÿæˆç»“æœå¦‚ä¸‹ï¼š </p>
<p><img src="%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae91837ec77" alt="å›¾ç‰‡" loading="lazy"></p>
<p>å¾—åˆ°ï¼š</p>
<p><img src="%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae923568c9c" alt="å›¾ç‰‡" loading="lazy"></p>
<p>ç®€æ´ï¼æ–¹ä¾¿ï¼ç»è¿‡ä¸Šé¢çš„æ­¥éª¤ï¼ŒåŸºæœ¬ä¸Šæˆ‘ä»¬å·²ç»æŠŠmybatis plusæ¡†æ¶é›†æˆåˆ°é¡¹ç›®ä¸­äº†ã€‚</p>
<p>psï¼šé¢ï¼Œæ³¨æ„ä¸€ä¸‹m_blogè¡¨çš„ä»£ç ä¹Ÿç”Ÿæˆä¸€ä¸‹å“ˆã€‚</p>
<p>åœ¨UserControllerä¸­å†™ä¸ªæµ‹è¯•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    UserService userService;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">test</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Long id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userService.getById(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è®¿é—®ï¼š<a target="_blank" rel="noopener" href="http://localhost:8080/user/1">http://localhost:8080/user/1</a> è·å¾—ç»“æœå¦‚ä¸‹ï¼Œæ•´åˆæˆåŠŸï¼ </p>
<p>![å›¾ç‰‡](data:image/svg+xml;utf8,<?xml version="1.0"?><svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="562" height="240"></svg>)</p>
<h3 id="3ã€ç»Ÿä¸€ç»“æœå°è£…"><a href="#3ã€ç»Ÿä¸€ç»“æœå°è£…" class="headerlink" title="3ã€ç»Ÿä¸€ç»“æœå°è£…"></a>3ã€ç»Ÿä¸€ç»“æœå°è£…</h3><p>è¿™é‡Œæˆ‘ä»¬ç”¨åˆ°äº†ä¸€ä¸ªResultçš„ç±»ï¼Œè¿™ä¸ªç”¨äºæˆ‘ä»¬çš„å¼‚æ­¥ç»Ÿä¸€è¿”å›çš„ç»“æœå°è£…ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œç»“æœé‡Œé¢æœ‰å‡ ä¸ªè¦ç´ å¿…è¦çš„</p>
<ul>
<li>æ˜¯å¦æˆåŠŸï¼Œå¯ç”¨codeè¡¨ç¤ºï¼ˆå¦‚200è¡¨ç¤ºæˆåŠŸï¼Œ400è¡¨ç¤ºå¼‚å¸¸ï¼‰</li>
<li>ç»“æœæ¶ˆæ¯</li>
<li>ç»“æœæ•°æ®</li>
</ul>
<p>æ‰€ä»¥å¯å¾—åˆ°å°è£…å¦‚ä¸‹ï¼š</p>
<ul>
<li>com.markerhub.common.lang.Result</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Result</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String code;</span><br><span class="line">    <span class="keyword">private</span> String msg;</span><br><span class="line">    <span class="keyword">private</span> Object data;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Result <span class="title">succ</span><span class="params">(Object data)</span> </span>&#123;</span><br><span class="line">        Result m = <span class="keyword">new</span> Result();</span><br><span class="line">        m.setCode(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">        m.setData(data);</span><br><span class="line">        m.setMsg(<span class="string">&quot;æ“ä½œæˆåŠŸ&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> m;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Result <span class="title">succ</span><span class="params">(String mess, Object data)</span> </span>&#123;</span><br><span class="line">        Result m = <span class="keyword">new</span> Result();</span><br><span class="line">        m.setCode(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">        m.setData(data);</span><br><span class="line">        m.setMsg(mess);</span><br><span class="line">        <span class="keyword">return</span> m;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Result <span class="title">fail</span><span class="params">(String mess)</span> </span>&#123;</span><br><span class="line">        Result m = <span class="keyword">new</span> Result();</span><br><span class="line">        m.setCode(<span class="string">&quot;-1&quot;</span>);</span><br><span class="line">        m.setData(<span class="keyword">null</span>);</span><br><span class="line">        m.setMsg(mess);</span><br><span class="line">        <span class="keyword">return</span> m;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Result <span class="title">fail</span><span class="params">(String mess, Object data)</span> </span>&#123;</span><br><span class="line">        Result m = <span class="keyword">new</span> Result();</span><br><span class="line">        m.setCode(<span class="string">&quot;-1&quot;</span>);</span><br><span class="line">        m.setData(data);</span><br><span class="line">        m.setMsg(mess);</span><br><span class="line">        <span class="keyword">return</span> m;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4ã€æ•´åˆshiro-jwtï¼Œå¹¶ä¼šè¯å…±äº«"><a href="#4ã€æ•´åˆshiro-jwtï¼Œå¹¶ä¼šè¯å…±äº«" class="headerlink" title="4ã€æ•´åˆshiro+jwtï¼Œå¹¶ä¼šè¯å…±äº«"></a>4ã€æ•´åˆshiro+jwtï¼Œå¹¶ä¼šè¯å…±äº«</h3><p>è€ƒè™‘åˆ°åé¢å¯èƒ½éœ€è¦åšé›†ç¾¤ã€è´Ÿè½½å‡è¡¡ç­‰ï¼Œæ‰€ä»¥å°±éœ€è¦ä¼šè¯å…±äº«ï¼Œè€Œshiroçš„ç¼“å­˜å’Œä¼šè¯ä¿¡æ¯ï¼Œæˆ‘ä»¬ä¸€èˆ¬è€ƒè™‘ä½¿ç”¨redisæ¥å­˜å‚¨è¿™äº›æ•°æ®ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬ä¸ä»…ä»…éœ€è¦æ•´åˆshiroï¼ŒåŒæ—¶ä¹Ÿéœ€è¦æ•´åˆredisã€‚åœ¨å¼€æºçš„é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†ä¸€ä¸ªstarterå¯ä»¥å¿«é€Ÿæ•´åˆshiro-redisï¼Œé…ç½®ç®€å•ï¼Œè¿™é‡Œä¹Ÿæ¨èå¤§å®¶ä½¿ç”¨ã€‚</p>
<p>è€Œå› ä¸ºæˆ‘ä»¬éœ€è¦åšçš„æ˜¯å‰åç«¯åˆ†ç¦»é¡¹ç›®çš„éª¨æ¶ï¼Œæ‰€ä»¥ä¸€èˆ¬æˆ‘ä»¬ä¼šé‡‡ç”¨tokenæˆ–è€…jwtä½œä¸ºè·¨åŸŸèº«ä»½éªŒè¯è§£å†³æ–¹æ¡ˆã€‚æ‰€ä»¥æ•´åˆshiroçš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥jwtçš„èº«ä»½éªŒè¯è¿‡ç¨‹ã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬å°±å¼€å§‹æ•´åˆï¼š</p>
<p>æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªshiro-redis-spring-boot-starterçš„jaråŒ…ï¼Œå…·ä½“æ•™ç¨‹å¯ä»¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼š<a target="_blank" rel="noopener" href="https://github.com/alexxiyang/shiro-redis/blob/master/docs/README.md#spring-boot-starter">github.com/alexxiyang/â€¦</a></p>
<p>ç¬¬ä¸€æ­¥ï¼šå¯¼å…¥shiro-redisçš„starteråŒ…ï¼šè¿˜æœ‰jwtçš„å·¥å…·åŒ…ï¼Œä»¥åŠä¸ºäº†ç®€åŒ–å¼€å‘ï¼Œæˆ‘å¼•å…¥äº†hutoolå·¥å…·åŒ…ã€‚</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.crazycake<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>shiro-redis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- hutoolå·¥å…·ç±»--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.hutool<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hutool-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- jwt --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.jsonwebtoken<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jjwt<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.9.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç¬¬äºŒæ­¥ï¼šç¼–å†™é…ç½®ï¼š</p>
<h4 id="ShiroConfig"><a href="#ShiroConfig" class="headerlink" title="ShiroConfig"></a>ShiroConfig</h4><ul>
<li>com.markerhub.config.ShiroConfig</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * shiroå¯ç”¨æ³¨è§£æ‹¦æˆªæ§åˆ¶å™¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ShiroConfig</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    JwtFilter jwtFilter;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> SessionManager <span class="title">sessionManager</span><span class="params">(RedisSessionDAO redisSessionDAO)</span> </span>&#123;</span><br><span class="line">        DefaultWebSessionManager sessionManager = <span class="keyword">new</span> DefaultWebSessionManager();</span><br><span class="line">        sessionManager.setSessionDAO(redisSessionDAO);</span><br><span class="line">        <span class="keyword">return</span> sessionManager;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> DefaultWebSecurityManager <span class="title">securityManager</span><span class="params">(AccountRealm accountRealm,</span></span></span><br><span class="line"><span class="params"><span class="function">                                                     SessionManager sessionManager,</span></span></span><br><span class="line"><span class="params"><span class="function">                                                     RedisCacheManager redisCacheManager)</span> </span>&#123;</span><br><span class="line">        DefaultWebSecurityManager securityManager = <span class="keyword">new</span> DefaultWebSecurityManager(accountRealm);</span><br><span class="line">        securityManager.setSessionManager(sessionManager);</span><br><span class="line">        securityManager.setCacheManager(redisCacheManager);</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * å…³é—­shiroè‡ªå¸¦çš„sessionï¼Œè¯¦æƒ…è§æ–‡æ¡£</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        DefaultSubjectDAO subjectDAO = <span class="keyword">new</span> DefaultSubjectDAO();</span><br><span class="line">        DefaultSessionStorageEvaluator defaultSessionStorageEvaluator = <span class="keyword">new</span> DefaultSessionStorageEvaluator();</span><br><span class="line">        defaultSessionStorageEvaluator.setSessionStorageEnabled(<span class="keyword">false</span>);</span><br><span class="line">        subjectDAO.setSessionStorageEvaluator(defaultSessionStorageEvaluator);</span><br><span class="line">        securityManager.setSubjectDAO(subjectDAO);</span><br><span class="line">        <span class="keyword">return</span> securityManager;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ShiroFilterChainDefinition <span class="title">shiroFilterChainDefinition</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        DefaultShiroFilterChainDefinition chainDefinition = <span class="keyword">new</span> DefaultShiroFilterChainDefinition();</span><br><span class="line">        Map&lt;String, String&gt; filterMap = <span class="keyword">new</span> LinkedHashMap&lt;&gt;();</span><br><span class="line">        filterMap.put(<span class="string">&quot;/**&quot;</span>, <span class="string">&quot;jwt&quot;</span>); <span class="comment">// ä¸»è¦é€šè¿‡æ³¨è§£æ–¹å¼æ ¡éªŒæƒé™</span></span><br><span class="line">        chainDefinition.addPathDefinitions(filterMap);</span><br><span class="line">        <span class="keyword">return</span> chainDefinition;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Bean(&quot;shiroFilterFactoryBean&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ShiroFilterFactoryBean <span class="title">shiroFilterFactoryBean</span><span class="params">(SecurityManager securityManager,</span></span></span><br><span class="line"><span class="params"><span class="function">                                                         ShiroFilterChainDefinition shiroFilterChainDefinition)</span> </span>&#123;</span><br><span class="line">        ShiroFilterFactoryBean shiroFilter = <span class="keyword">new</span> ShiroFilterFactoryBean();</span><br><span class="line">        shiroFilter.setSecurityManager(securityManager);</span><br><span class="line">        Map&lt;String, Filter&gt; filters = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        filters.put(<span class="string">&quot;jwt&quot;</span>, jwtFilter);</span><br><span class="line">        shiroFilter.setFilters(filters);</span><br><span class="line">        Map&lt;String, String&gt; filterMap = shiroFilterChainDefinition.getFilterChainMap();</span><br><span class="line">        shiroFilter.setFilterChainDefinitionMap(filterMap);</span><br><span class="line">        <span class="keyword">return</span> shiroFilter;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¼€å¯æ³¨è§£ä»£ç†ï¼ˆé»˜è®¤å¥½åƒå·²ç»å¼€å¯ï¼Œå¯ä»¥ä¸è¦ï¼‰</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> AuthorizationAttributeSourceAdvisor <span class="title">authorizationAttributeSourceAdvisor</span><span class="params">(SecurityManager securityManager)</span></span>&#123;</span><br><span class="line">        AuthorizationAttributeSourceAdvisor authorizationAttributeSourceAdvisor = <span class="keyword">new</span> AuthorizationAttributeSourceAdvisor();</span><br><span class="line">        authorizationAttributeSourceAdvisor.setSecurityManager(securityManager);</span><br><span class="line">        <span class="keyword">return</span> authorizationAttributeSourceAdvisor;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DefaultAdvisorAutoProxyCreator <span class="title">getDefaultAdvisorAutoProxyCreator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        DefaultAdvisorAutoProxyCreator creator = <span class="keyword">new</span> DefaultAdvisorAutoProxyCreator();</span><br><span class="line">        <span class="keyword">return</span> creator;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ShiroConfigï¼Œæˆ‘ä»¬ä¸»è¦åšäº†å‡ ä»¶äº‹æƒ…ï¼š</p>
<ol>
<li>å¼•å…¥RedisSessionDAOå’ŒRedisCacheManagerï¼Œä¸ºäº†è§£å†³shiroçš„æƒé™æ•°æ®å’Œä¼šè¯ä¿¡æ¯èƒ½ä¿å­˜åˆ°redisä¸­ï¼Œå®ç°ä¼šè¯å…±äº«ã€‚</li>
<li>é‡å†™äº†SessionManagerå’ŒDefaultWebSecurityManagerï¼ŒåŒæ—¶åœ¨DefaultWebSecurityManagerä¸­ä¸ºäº†å…³é—­shiroè‡ªå¸¦çš„sessionæ–¹å¼ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®ä¸ºfalseï¼Œè¿™æ ·ç”¨æˆ·å°±ä¸å†èƒ½é€šè¿‡sessionæ–¹å¼ç™»å½•shiroã€‚åé¢å°†é‡‡ç”¨jwtå‡­è¯ç™»å½•ã€‚</li>
<li>åœ¨ShiroFilterChainDefinitionä¸­ï¼Œæˆ‘ä»¬ä¸å†é€šè¿‡ç¼–ç å½¢å¼æ‹¦æˆªControllerè®¿é—®è·¯å¾„ï¼Œè€Œæ˜¯æ‰€æœ‰çš„è·¯ç”±éƒ½éœ€è¦ç»è¿‡JwtFilterè¿™ä¸ªè¿‡æ»¤å™¨ï¼Œç„¶ååˆ¤æ–­è¯·æ±‚å¤´ä¸­æ˜¯å¦å«æœ‰jwtçš„ä¿¡æ¯ï¼Œæœ‰å°±ç™»å½•ï¼Œæ²¡æœ‰å°±è·³è¿‡ã€‚è·³è¿‡ä¹‹åï¼Œæœ‰Controllerä¸­çš„shiroæ³¨è§£è¿›è¡Œå†æ¬¡æ‹¦æˆªï¼Œæ¯”å¦‚@RequiresAuthenticationï¼Œè¿™æ ·æ§åˆ¶æƒé™è®¿é—®ã€‚</li>
</ol>
<p>é‚£ä¹ˆï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬èŠèŠShiroConfigä¸­å‡ºç°çš„AccountRealmï¼Œè¿˜æœ‰JwtFilterã€‚</p>
<h4 id="AccountRealm"><a href="#AccountRealm" class="headerlink" title="AccountRealm"></a>AccountRealm</h4><p>AccountRealmæ˜¯shiroè¿›è¡Œç™»å½•æˆ–è€…æƒé™æ ¡éªŒçš„é€»è¾‘æ‰€åœ¨ï¼Œç®—æ˜¯æ ¸å¿ƒäº†ï¼Œæˆ‘ä»¬éœ€è¦é‡å†™3ä¸ªæ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯</p>
<ul>
<li>supportsï¼šä¸ºäº†è®©realmæ”¯æŒjwtçš„å‡­è¯æ ¡éªŒ</li>
<li>doGetAuthorizationInfoï¼šæƒé™æ ¡éªŒ</li>
<li>doGetAuthenticationInfoï¼šç™»å½•è®¤è¯æ ¡éªŒ</li>
</ul>
<p>æˆ‘ä»¬å…ˆæ¥æ€»ä½“çœ‹çœ‹AccountRealmçš„ä»£ç ï¼Œç„¶åé€ä¸ªåˆ†æï¼š</p>
<ul>
<li>com.markerhub.shiro.AccountRealm</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountRealm</span> <span class="keyword">extends</span> <span class="title">AuthorizingRealm</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    JwtUtils jwtUtils;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    UserService userService;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supports</span><span class="params">(AuthenticationToken token)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> token <span class="keyword">instanceof</span> JwtToken;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> AuthorizationInfo <span class="title">doGetAuthorizationInfo</span><span class="params">(PrincipalCollection principals)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> AuthenticationInfo <span class="title">doGetAuthenticationInfo</span><span class="params">(AuthenticationToken token)</span> <span class="keyword">throws</span> AuthenticationException </span>&#123;</span><br><span class="line">        JwtToken jwt = (JwtToken) token;</span><br><span class="line">        log.info(<span class="string">&quot;jwt-----------------&gt;&#123;&#125;&quot;</span>, jwt);</span><br><span class="line">        String userId = jwtUtils.getClaimByToken((String) jwt.getPrincipal()).getSubject();</span><br><span class="line">        User user = userService.getById(Long.parseLong(userId));</span><br><span class="line">        <span class="keyword">if</span>(user == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> UnknownAccountException(<span class="string">&quot;è´¦æˆ·ä¸å­˜åœ¨ï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(user.getStatus() == -<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> LockedAccountException(<span class="string">&quot;è´¦æˆ·å·²è¢«é”å®šï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        AccountProfile profile = <span class="keyword">new</span> AccountProfile();</span><br><span class="line">        BeanUtil.copyProperties(user, profile);</span><br><span class="line">        log.info(<span class="string">&quot;profile-----------------&gt;&#123;&#125;&quot;</span>, profile.toString());</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SimpleAuthenticationInfo(profile, jwt.getCredentials(), getName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…¶å®ä¸»è¦å°±æ˜¯doGetAuthenticationInfoç™»å½•è®¤è¯è¿™ä¸ªæ–¹æ³•ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬é€šè¿‡jwtè·å–åˆ°ç”¨æˆ·ä¿¡æ¯ï¼Œåˆ¤æ–­ç”¨æˆ·çš„çŠ¶æ€ï¼Œæœ€åå¼‚å¸¸å°±æŠ›å‡ºå¯¹åº”çš„å¼‚å¸¸ä¿¡æ¯ï¼Œå¦è€…å°è£…æˆSimpleAuthenticationInfoè¿”å›ç»™shiroã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬é€æ­¥åˆ†æé‡Œé¢å‡ºç°çš„æ–°ç±»ï¼š</p>
<p>1ã€shiroé»˜è®¤supportsçš„æ˜¯UsernamePasswordTokenï¼Œè€Œæˆ‘ä»¬ç°åœ¨é‡‡ç”¨äº†jwtçš„æ–¹å¼ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬è‡ªå®šä¹‰ä¸€ä¸ªJwtTokenï¼Œæ¥å®Œæˆshiroçš„supportsæ–¹æ³•ã€‚</p>
<h4 id="JwtToken"><a href="#JwtToken" class="headerlink" title="JwtToken"></a>JwtToken</h4><ul>
<li>com.markerhub.shiro.JwtToken</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JwtToken</span> <span class="keyword">implements</span> <span class="title">AuthenticationToken</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String token;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">JwtToken</span><span class="params">(String token)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.token = token;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">getPrincipal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> token;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">getCredentials</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> token;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2ã€JwtUtilsæ˜¯ä¸ªç”Ÿæˆå’Œæ ¡éªŒjwtçš„å·¥å…·ç±»ï¼Œå…¶ä¸­æœ‰äº›jwtç›¸å…³çš„å¯†é’¥ä¿¡æ¯æ˜¯ä»é¡¹ç›®é…ç½®æ–‡ä»¶ä¸­é…ç½®çš„ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;markerhub.jwt&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JwtUtils</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String secret;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> expire;</span><br><span class="line">    <span class="keyword">private</span> String header;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”Ÿæˆjwt token</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">generateToken</span><span class="params">(<span class="keyword">long</span> userId)</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è·å–jwtçš„ä¿¡æ¯</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Claims <span class="title">getClaimByToken</span><span class="params">(String token)</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * tokenæ˜¯å¦è¿‡æœŸ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>  trueï¼šè¿‡æœŸ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isTokenExpired</span><span class="params">(Date expiration)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> expiration.before(<span class="keyword">new</span> Date());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3ã€è€Œåœ¨AccountRealmæˆ‘ä»¬è¿˜ç”¨åˆ°äº†AccountProfileï¼Œè¿™æ˜¯ä¸ºäº†ç™»å½•æˆåŠŸä¹‹åè¿”å›çš„ä¸€ä¸ªç”¨æˆ·ä¿¡æ¯çš„è½½ä½“ï¼Œ</p>
<h4 id="AccountProfile"><a href="#AccountProfile" class="headerlink" title="AccountProfile"></a>AccountProfile</h4><ul>
<li>com.markerhub.shiro.AccountProfile</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountProfile</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String avatar;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸‰æ­¥ï¼Œokï¼ŒåŸºæœ¬çš„æ ¡éªŒçš„è·¯çº¿å®Œæˆä¹‹åï¼Œæˆ‘ä»¬éœ€è¦å°‘é‡çš„åŸºæœ¬ä¿¡æ¯é…ç½®ï¼š</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">shiro-redis</span>:<span class="string"></span></span><br><span class="line">  <span class="attr">enabled</span>: <span class="string">true</span></span><br><span class="line">  <span class="meta">redis-manager</span>:<span class="string"></span></span><br><span class="line">    <span class="attr">host</span>: <span class="string">127.0.0.1:6379</span></span><br><span class="line"><span class="attr">markerhub</span>:<span class="string"></span></span><br><span class="line">  <span class="attr">jwt</span>:<span class="string"></span></span><br><span class="line"><span class="comment">    # åŠ å¯†ç§˜é’¥</span></span><br><span class="line">    <span class="attr">secret</span>: <span class="string">f4e2e52034348f86b67cde581c0f9eb5</span></span><br><span class="line"><span class="comment">    # tokenæœ‰æ•ˆæ—¶é•¿ï¼Œ7å¤©ï¼Œå•ä½ç§’</span></span><br><span class="line">    <span class="attr">expire</span>: <span class="string">604800</span></span><br><span class="line">    <span class="attr">header</span>: <span class="string">token</span></span><br></pre></td></tr></table></figure>

<p>ç¬¬å››æ­¥ï¼šå¦å¤–ï¼Œå¦‚æœä½ é¡¹ç›®æœ‰ä½¿ç”¨spring-boot-devtoolsï¼Œéœ€è¦æ·»åŠ ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œåœ¨resourcesç›®å½•ä¸‹æ–°å»ºæ–‡ä»¶å¤¹META-INFï¼Œç„¶åæ–°å»ºæ–‡ä»¶spring-devtools.propertiesï¼Œè¿™æ ·çƒ­é‡å¯æ—¶å€™æ‰ä¸ä¼šæŠ¥é”™ã€‚</p>
<ul>
<li>resources/META-INF/spring-devtools.properties</li>
</ul>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">restart.include.shiro-redis</span>=<span class="string">/shiro-[\\w-\\.]+jar</span></span><br></pre></td></tr></table></figure>



<p> <img src="%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae9524d355a" alt="img" loading="lazy"> </p>
<h4 id="JwtFilter"><a href="#JwtFilter" class="headerlink" title="JwtFilter"></a>JwtFilter</h4><p>ç¬¬äº”æ­¥ï¼šå®šä¹‰jwtçš„è¿‡æ»¤å™¨JwtFilterã€‚</p>
<p>è¿™ä¸ªè¿‡æ»¤å™¨æ˜¯æˆ‘ä»¬çš„é‡ç‚¹ï¼Œè¿™é‡Œæˆ‘ä»¬ç»§æ‰¿çš„æ˜¯Shiroå†…ç½®çš„AuthenticatingFilterï¼Œä¸€ä¸ªå¯ä»¥å†…ç½®äº†å¯ä»¥è‡ªåŠ¨ç™»å½•æ–¹æ³•çš„çš„è¿‡æ»¤å™¨ï¼Œæœ‰äº›åŒå­¦ç»§æ‰¿BasicHttpAuthenticationFilterä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦é‡å†™å‡ ä¸ªæ–¹æ³•ï¼š</p>
<ol>
<li>createTokenï¼šå®ç°ç™»å½•ï¼Œæˆ‘ä»¬éœ€è¦ç”Ÿæˆæˆ‘ä»¬è‡ªå®šä¹‰æ”¯æŒçš„JwtToken</li>
<li>onAccessDeniedï¼šæ‹¦æˆªæ ¡éªŒï¼Œå½“å¤´éƒ¨æ²¡æœ‰Authorizationæ—¶å€™ï¼Œæˆ‘ä»¬ç›´æ¥é€šè¿‡ï¼Œä¸éœ€è¦è‡ªåŠ¨ç™»å½•ï¼›å½“å¸¦æœ‰çš„æ—¶å€™ï¼Œé¦–å…ˆæˆ‘ä»¬æ ¡éªŒjwtçš„æœ‰æ•ˆæ€§ï¼Œæ²¡é—®é¢˜æˆ‘ä»¬å°±ç›´æ¥æ‰§è¡ŒexecuteLoginæ–¹æ³•å®ç°è‡ªåŠ¨ç™»å½•</li>
<li>onLoginFailureï¼šç™»å½•å¼‚å¸¸æ—¶å€™è¿›å…¥çš„æ–¹æ³•ï¼Œæˆ‘ä»¬ç›´æ¥æŠŠå¼‚å¸¸ä¿¡æ¯å°è£…ç„¶åæŠ›å‡º</li>
<li>preHandleï¼šæ‹¦æˆªå™¨çš„å‰ç½®æ‹¦æˆªï¼Œå› ä¸ºæˆ‘ä»¬æ˜¯å‰åç«¯åˆ†æé¡¹ç›®ï¼Œé¡¹ç›®ä¸­é™¤äº†éœ€è¦è·¨åŸŸå…¨å±€é…ç½®ä¹‹å¤–ï¼Œæˆ‘ä»¬å†æ‹¦æˆªå™¨ä¸­ä¹Ÿéœ€è¦æä¾›è·¨åŸŸæ”¯æŒã€‚è¿™æ ·ï¼Œæ‹¦æˆªå™¨æ‰ä¸ä¼šåœ¨è¿›å…¥Controllerä¹‹å‰å°±è¢«é™åˆ¶äº†ã€‚</li>
</ol>
<p>ä¸‹é¢æˆ‘ä»¬çœ‹çœ‹æ€»ä½“çš„ä»£ç ï¼š</p>
<ul>
<li>com.markerhub.shiro.JwtFilter</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JwtFilter</span> <span class="keyword">extends</span> <span class="title">AuthenticatingFilter</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    JwtUtils jwtUtils;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> AuthenticationToken <span class="title">createToken</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// è·å– token</span></span><br><span class="line">        HttpServletRequest request = (HttpServletRequest) servletRequest;</span><br><span class="line">        String jwt = request.getHeader(<span class="string">&quot;Authorization&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(StringUtils.isEmpty(jwt))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> JwtToken(jwt);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">boolean</span> <span class="title">onAccessDenied</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        HttpServletRequest request = (HttpServletRequest) servletRequest;</span><br><span class="line">        String token = request.getHeader(<span class="string">&quot;Authorization&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(StringUtils.isEmpty(token)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// åˆ¤æ–­æ˜¯å¦å·²è¿‡æœŸ</span></span><br><span class="line">            Claims claim = jwtUtils.getClaimByToken(token);</span><br><span class="line">            <span class="keyword">if</span>(claim == <span class="keyword">null</span> || jwtUtils.isTokenExpired(claim.getExpiration())) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> ExpiredCredentialsException(<span class="string">&quot;tokenå·²å¤±æ•ˆï¼Œè¯·é‡æ–°ç™»å½•ï¼&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ‰§è¡Œè‡ªåŠ¨ç™»å½•</span></span><br><span class="line">        <span class="keyword">return</span> executeLogin(servletRequest, servletResponse);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">boolean</span> <span class="title">onLoginFailure</span><span class="params">(AuthenticationToken token, AuthenticationException e, ServletRequest request, ServletResponse response)</span> </span>&#123;</span><br><span class="line">        HttpServletResponse httpResponse = (HttpServletResponse) response;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//å¤„ç†ç™»å½•å¤±è´¥çš„å¼‚å¸¸</span></span><br><span class="line">            Throwable throwable = e.getCause() == <span class="keyword">null</span> ? e : e.getCause();</span><br><span class="line">            Result r = Result.fail(throwable.getMessage());</span><br><span class="line">            String json = JSONUtil.toJsonStr(r);</span><br><span class="line">            httpResponse.getWriter().print(json);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e1) &#123;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¯¹è·¨åŸŸæä¾›æ”¯æŒ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(ServletRequest request, ServletResponse response)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        HttpServletRequest httpServletRequest = WebUtils.toHttp(request);</span><br><span class="line">        HttpServletResponse httpServletResponse = WebUtils.toHttp(response);</span><br><span class="line">        httpServletResponse.setHeader(<span class="string">&quot;Access-control-Allow-Origin&quot;</span>, httpServletRequest.getHeader(<span class="string">&quot;Origin&quot;</span>));</span><br><span class="line">        httpServletResponse.setHeader(<span class="string">&quot;Access-Control-Allow-Methods&quot;</span>, <span class="string">&quot;GET,POST,OPTIONS,PUT,DELETE&quot;</span>);</span><br><span class="line">        httpServletResponse.setHeader(<span class="string">&quot;Access-Control-Allow-Headers&quot;</span>, httpServletRequest.getHeader(<span class="string">&quot;Access-Control-Request-Headers&quot;</span>));</span><br><span class="line">        <span class="comment">// è·¨åŸŸæ—¶ä¼šé¦–å…ˆå‘é€ä¸€ä¸ªOPTIONSè¯·æ±‚ï¼Œè¿™é‡Œæˆ‘ä»¬ç»™OPTIONSè¯·æ±‚ç›´æ¥è¿”å›æ­£å¸¸çŠ¶æ€</span></span><br><span class="line">        <span class="keyword">if</span> (httpServletRequest.getMethod().equals(RequestMethod.OPTIONS.name())) &#123;</span><br><span class="line">            httpServletResponse.setStatus(org.springframework.http.HttpStatus.OK.value());</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.preHandle(request, response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é‚£ä¹ˆåˆ°è¿™é‡Œï¼Œæˆ‘ä»¬çš„shiroå°±å·²ç»å®Œæˆæ•´åˆè¿›æ¥äº†ï¼Œå¹¶ä¸”ä½¿ç”¨äº†jwtè¿›è¡Œèº«ä»½æ ¡éªŒã€‚</p>
<h3 id="5ã€å¼‚å¸¸å¤„ç†"><a href="#5ã€å¼‚å¸¸å¤„ç†" class="headerlink" title="5ã€å¼‚å¸¸å¤„ç†"></a>5ã€å¼‚å¸¸å¤„ç†</h3><p>æœ‰æ—¶å€™ä¸å¯é¿å…æœåŠ¡å™¨æŠ¥é”™çš„æƒ…å†µï¼Œå¦‚æœä¸é…ç½®å¼‚å¸¸å¤„ç†æœºåˆ¶ï¼Œå°±ä¼šé»˜è®¤è¿”å›tomcatæˆ–è€…nginxçš„5XXé¡µé¢ï¼Œå¯¹æ™®é€šç”¨æˆ·æ¥è¯´ï¼Œä¸å¤ªå‹å¥½ï¼Œç”¨æˆ·ä¹Ÿä¸æ‡‚ä»€ä¹ˆæƒ…å†µã€‚è¿™æ—¶å€™éœ€è¦æˆ‘ä»¬ç¨‹åºå‘˜è®¾è®¡è¿”å›ä¸€ä¸ªå‹å¥½ç®€å•çš„æ ¼å¼ç»™å‰ç«¯ã€‚</p>
<p>å¤„ç†åŠæ³•å¦‚ä¸‹ï¼šé€šè¿‡ä½¿ç”¨@ControllerAdviceæ¥è¿›è¡Œç»Ÿä¸€å¼‚å¸¸å¤„ç†ï¼Œ@ExceptionHandler(value = RuntimeException.class)æ¥æŒ‡å®šæ•è·çš„Exceptionå„ä¸ªç±»å‹å¼‚å¸¸ ï¼Œè¿™ä¸ªå¼‚å¸¸çš„å¤„ç†ï¼Œæ˜¯å…¨å±€çš„ï¼Œæ‰€æœ‰ç±»ä¼¼çš„å¼‚å¸¸ï¼Œéƒ½ä¼šè·‘åˆ°è¿™ä¸ªåœ°æ–¹å¤„ç†ã€‚</p>
<ul>
<li>com.markerhub.common.exception.GlobalExceptionHandler</li>
</ul>
<p>æ­¥éª¤äºŒã€å®šä¹‰å…¨å±€å¼‚å¸¸å¤„ç†ï¼Œ@ControllerAdviceè¡¨ç¤ºå®šä¹‰å…¨å±€æ§åˆ¶å™¨å¼‚å¸¸å¤„ç†ï¼Œ@ExceptionHandlerè¡¨ç¤ºé’ˆå¯¹æ€§å¼‚å¸¸å¤„ç†ï¼Œå¯å¯¹æ¯ç§å¼‚å¸¸é’ˆå¯¹æ€§å¤„ç†ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å…¨å±€å¼‚å¸¸å¤„ç†</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@RestControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GlobalExcepitonHandler</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ•æ‰shiroçš„å¼‚å¸¸</span></span><br><span class="line">    <span class="meta">@ResponseStatus(HttpStatus.UNAUTHORIZED)</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(ShiroException.class)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">handle401</span><span class="params">(ShiroException e)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Result.fail(<span class="number">401</span>, e.getMessage(), <span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¤„ç†Assertçš„å¼‚å¸¸</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ResponseStatus(HttpStatus.BAD_REQUEST)</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(value = IllegalArgumentException.class)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">handler</span><span class="params">(IllegalArgumentException e)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        log.error(<span class="string">&quot;Assertå¼‚å¸¸:--------------&gt;&#123;&#125;&quot;</span>,e.getMessage());</span><br><span class="line">        <span class="keyword">return</span> Result.fail(e.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Validated</span> æ ¡éªŒé”™è¯¯å¼‚å¸¸å¤„ç†</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ResponseStatus(HttpStatus.BAD_REQUEST)</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(value = MethodArgumentNotValidException.class)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">handler</span><span class="params">(MethodArgumentNotValidException e)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        log.error(<span class="string">&quot;è¿è¡Œæ—¶å¼‚å¸¸:--------------&gt;&quot;</span>,e);</span><br><span class="line">        BindingResult bindingResult = e.getBindingResult();</span><br><span class="line">        ObjectError objectError = bindingResult.getAllErrors().stream().findFirst().get();</span><br><span class="line">        <span class="keyword">return</span> Result.fail(objectError.getDefaultMessage());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ResponseStatus(HttpStatus.BAD_REQUEST)</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(value = RuntimeException.class)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">handler</span><span class="params">(RuntimeException e)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        log.error(<span class="string">&quot;è¿è¡Œæ—¶å¼‚å¸¸:--------------&gt;&quot;</span>,e);</span><br><span class="line">        <span class="keyword">return</span> Result.fail(e.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢æˆ‘ä»¬æ•æ‰äº†å‡ ä¸ªå¼‚å¸¸ï¼š</p>
<ul>
<li>ShiroExceptionï¼šshiroæŠ›å‡ºçš„å¼‚å¸¸ï¼Œæ¯”å¦‚æ²¡æœ‰æƒé™ï¼Œç”¨æˆ·ç™»å½•å¼‚å¸¸</li>
<li>IllegalArgumentExceptionï¼šå¤„ç†Assertçš„å¼‚å¸¸</li>
<li>MethodArgumentNotValidExceptionï¼šå¤„ç†å®ä½“æ ¡éªŒçš„å¼‚å¸¸</li>
<li>RuntimeExceptionï¼šæ•æ‰å…¶ä»–å¼‚å¸¸</li>
</ul>
<h3 id="6ã€å®ä½“æ ¡éªŒ"><a href="#6ã€å®ä½“æ ¡éªŒ" class="headerlink" title="6ã€å®ä½“æ ¡éªŒ"></a>6ã€å®ä½“æ ¡éªŒ</h3><p>å½“æˆ‘ä»¬è¡¨å•æ•°æ®æäº¤çš„æ—¶å€™ï¼Œå‰ç«¯çš„æ ¡éªŒæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€äº›ç±»ä¼¼äºjQuery Validateç­‰jsæ’ä»¶å®ç°ï¼Œè€Œåç«¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Hibernate validatioræ¥åšæ ¡éªŒã€‚</p>
<p>æˆ‘ä»¬ä½¿ç”¨springbootæ¡†æ¶ä½œä¸ºåŸºç¡€ï¼Œé‚£ä¹ˆå°±å·²ç»è‡ªåŠ¨é›†æˆäº†Hibernate validatiorã€‚</p>
<p>é‚£ä¹ˆç”¨èµ·æ¥å•¥æ ·å­çš„å‘¢ï¼Ÿ</p>
<p>ç¬¬ä¸€æ­¥ï¼šé¦–å…ˆåœ¨å®ä½“çš„å±æ€§ä¸Šæ·»åŠ å¯¹åº”çš„æ ¡éªŒè§„åˆ™ï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@TableName(&quot;m_user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">    <span class="meta">@TableId(value = &quot;id&quot;, type = IdType.AUTO)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="meta">@NotBlank(message = &quot;æ˜µç§°ä¸èƒ½ä¸ºç©º&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="meta">@NotBlank(message = &quot;é‚®ç®±ä¸èƒ½ä¸ºç©º&quot;)</span></span><br><span class="line">    <span class="meta">@Email(message = &quot;é‚®ç®±æ ¼å¼ä¸æ­£ç¡®&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">    </span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç¬¬äºŒæ­¥ ï¼šè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨@Validatedæ³¨è§£æ–¹å¼ï¼Œå¦‚æœå®ä½“ä¸ç¬¦åˆè¦æ±‚ï¼Œç³»ç»Ÿä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„å¼‚å¸¸å¤„ç†ä¸­å°±æ•è·åˆ°MethodArgumentNotValidExceptionã€‚</p>
<ul>
<li>com.markerhub.controller.UserController</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æµ‹è¯•å®ä½“æ ¡éªŒ</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> user</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/save&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">testUser</span><span class="params">(<span class="meta">@Validated</span> <span class="meta">@RequestBody</span> User user)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> user.toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7ã€è·¨åŸŸé—®é¢˜"><a href="#7ã€è·¨åŸŸé—®é¢˜" class="headerlink" title="7ã€è·¨åŸŸé—®é¢˜"></a>7ã€è·¨åŸŸé—®é¢˜</h3><p>å› ä¸ºæ˜¯å‰åç«¯åˆ†æï¼Œæ‰€ä»¥è·¨åŸŸé—®é¢˜æ˜¯é¿å…ä¸äº†çš„ï¼Œæˆ‘ä»¬ç›´æ¥åœ¨åå°è¿›è¡Œå…¨å±€è·¨åŸŸå¤„ç†ï¼š</p>
<ul>
<li>com.markerhub.config.CorsConfig</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è§£å†³è·¨åŸŸé—®é¢˜</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CorsConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addCorsMappings</span><span class="params">(CorsRegistry registry)</span> </span>&#123;</span><br><span class="line">        registry.addMapping(<span class="string">&quot;/**&quot;</span>)</span><br><span class="line">                .allowedOrigins(<span class="string">&quot;*&quot;</span>)</span><br><span class="line">                .allowedMethods(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;HEAD&quot;</span>, <span class="string">&quot;POST&quot;</span>, <span class="string">&quot;PUT&quot;</span>, <span class="string">&quot;DELETE&quot;</span>, <span class="string">&quot;OPTIONS&quot;</span>)</span><br><span class="line">                .allowCredentials(<span class="keyword">true</span>)</span><br><span class="line">                .maxAge(<span class="number">3600</span>)</span><br><span class="line">                .allowedHeaders(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>okï¼Œå› ä¸ºæˆ‘ä»¬ç³»ç»Ÿå¼€å‘çš„æ¥å£æ¯”è¾ƒç®€å•ï¼Œæ‰€ä»¥æˆ‘å°±ä¸é›†æˆswagger2å•¦ï¼Œä¹Ÿæ¯”è¾ƒç®€å•è€Œå·²ã€‚ä¸‹é¢æˆ‘ä»¬å°±ç›´æ¥è¿›å…¥æˆ‘ä»¬çš„æ­£é¢˜ï¼Œè¿›è¡Œç¼–å†™ç™»å½•æ¥å£ã€‚</p>
<h3 id="8ã€ç™»å½•æ¥å£å¼€å‘"><a href="#8ã€ç™»å½•æ¥å£å¼€å‘" class="headerlink" title="8ã€ç™»å½•æ¥å£å¼€å‘"></a>8ã€ç™»å½•æ¥å£å¼€å‘</h3><p>ç™»å½•çš„é€»è¾‘å…¶å®å¾ˆç®€ç­”ï¼Œåªéœ€è¦æ¥å—è´¦å·å¯†ç ï¼Œç„¶åæŠŠç”¨æˆ·çš„idç”Ÿæˆjwtï¼Œè¿”å›ç»™å‰æ®µï¼Œä¸ºäº†åç»­çš„jwtçš„å»¶æœŸï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠjwtæ”¾åœ¨headerä¸Šã€‚å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<ul>
<li>com.markerhub.controller.AccountController</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    JwtUtils jwtUtils;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    UserService userService;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é»˜è®¤è´¦å·å¯†ç ï¼šmarkerhub / 111111</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@CrossOrigin</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/login&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">login</span><span class="params">(<span class="meta">@Validated</span> <span class="meta">@RequestBody</span> LoginDto loginDto, HttpServletResponse response)</span> </span>&#123;</span><br><span class="line">        User user = userService.getOne(<span class="keyword">new</span> QueryWrapper&lt;User&gt;().eq(<span class="string">&quot;username&quot;</span>, loginDto.getUsername()));</span><br><span class="line">        Assert.notNull(user, <span class="string">&quot;ç”¨æˆ·ä¸å­˜åœ¨&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(!user.getPassword().equals(SecureUtil.md5(loginDto.getPassword()))) &#123;</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;å¯†ç é”™è¯¯ï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        String jwt = jwtUtils.generateToken(user.getId());</span><br><span class="line">        response.setHeader(<span class="string">&quot;Authorization&quot;</span>, jwt);</span><br><span class="line">        response.setHeader(<span class="string">&quot;Access-Control-Expose-Headers&quot;</span>, <span class="string">&quot;Authorization&quot;</span>);</span><br><span class="line">        <span class="comment">// ç”¨æˆ·å¯ä»¥å¦ä¸€ä¸ªæ¥å£</span></span><br><span class="line">        <span class="keyword">return</span> Result.succ(MapUtil.builder()</span><br><span class="line">                .put(<span class="string">&quot;id&quot;</span>, user.getId())</span><br><span class="line">                .put(<span class="string">&quot;username&quot;</span>, user.getUsername())</span><br><span class="line">                .put(<span class="string">&quot;avatar&quot;</span>, user.getAvatar())</span><br><span class="line">                .put(<span class="string">&quot;email&quot;</span>, user.getEmail())</span><br><span class="line">                .map()</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// é€€å‡º</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/logout&quot;)</span></span><br><span class="line">    <span class="meta">@RequiresAuthentication</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">logout</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        SecurityUtils.getSubject().logout();</span><br><span class="line">        <span class="keyword">return</span> Result.succ(<span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ¥å£æµ‹è¯•ï¼š </p>
<p><img src="%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae94b89988f" alt="å›¾ç‰‡" loading="lazy"></p>
<h3 id="9ã€åšå®¢æ¥å£å¼€å‘"><a href="#9ã€åšå®¢æ¥å£å¼€å‘" class="headerlink" title="9ã€åšå®¢æ¥å£å¼€å‘"></a>9ã€åšå®¢æ¥å£å¼€å‘</h3><p>æˆ‘ä»¬çš„éª¨æ¶å·²ç»å®Œæˆï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ·»åŠ æˆ‘ä»¬çš„ä¸šåŠ¡æ¥å£äº†ï¼Œä¸‹é¢æˆ‘ä»¥ä¸€ä¸ªç®€å•çš„åšå®¢åˆ—è¡¨ã€åšå®¢è¯¦æƒ…é¡µä¸ºä¾‹å­å¼€å‘ï¼š</p>
<ul>
<li>com.markerhub.controller.BlogController</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BlogController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    BlogService blogService;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/blogs&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">blogs</span><span class="params">(Integer currentPage)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(currentPage == <span class="keyword">null</span> || currentPage &lt; <span class="number">1</span>) currentPage = <span class="number">1</span>;</span><br><span class="line">        Page page = <span class="keyword">new</span> Page(currentPage, <span class="number">5</span>)</span><br><span class="line">        IPage pageData = blogService.page(page, <span class="keyword">new</span> QueryWrapper&lt;Blog&gt;().orderByDesc(<span class="string">&quot;created&quot;</span>));</span><br><span class="line">        <span class="keyword">return</span> Result.succ(pageData);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/blog/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">detail</span><span class="params">(<span class="meta">@PathVariable(name = &quot;id&quot;)</span> Long id)</span> </span>&#123;</span><br><span class="line">        Blog blog = blogService.getById(id);</span><br><span class="line">        Assert.notNull(blog, <span class="string">&quot;è¯¥åšå®¢å·²åˆ é™¤ï¼&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> Result.succ(blog);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@RequiresAuthentication</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/blog/edit&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Result <span class="title">edit</span><span class="params">(<span class="meta">@Validated</span> <span class="meta">@RequestBody</span> Blog blog)</span> </span>&#123;</span><br><span class="line">    System.out.println(blog.toString());</span><br><span class="line">    Blog temp = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">if</span>(blog.getId() != <span class="keyword">null</span>) &#123;</span><br><span class="line">        temp = blogService.getById(blog.getId());</span><br><span class="line">        Assert.isTrue(temp.getUserId() == ShiroUtil.getProfile().getId(), <span class="string">&quot;æ²¡æœ‰æƒé™ç¼–è¾‘&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        temp = <span class="keyword">new</span> Blog();</span><br><span class="line">        temp.setUserId(ShiroUtil.getProfile().getId());</span><br><span class="line">        temp.setCreated(LocalDateTime.now());</span><br><span class="line">        temp.setStatus(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    BeanUtil.copyProperties(blog, temp, <span class="string">&quot;id&quot;</span>, <span class="string">&quot;userId&quot;</span>, <span class="string">&quot;created&quot;</span>, <span class="string">&quot;status&quot;</span>);</span><br><span class="line">    blogService.saveOrUpdate(temp);</span><br><span class="line">    <span class="keyword">return</span> Result.succ(<span class="string">&quot;æ“ä½œæˆåŠŸ&quot;</span>, <span class="keyword">null</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„@RequiresAuthenticationè¯´æ˜éœ€è¦ç™»å½•ä¹‹åæ‰èƒ½è®¿é—®çš„æ¥å£ï¼Œå…¶ä»–éœ€è¦æƒé™çš„æ¥å£å¯ä»¥æ·»åŠ shiroçš„ç›¸å…³æ³¨è§£ã€‚ æ¥å£æ¯”è¾ƒç®€å•ï¼Œæˆ‘ä»¬å°±ä¸å¤šè¯´äº†ï¼ŒåŸºæœ¬å¢åˆ æ”¹æŸ¥è€Œå·²ã€‚æ³¨æ„çš„æ˜¯editæ–¹æ³•æ˜¯éœ€è¦ç™»å½•æ‰èƒ½æ“ä½œçš„å—é™èµ„æºã€‚</p>
<p>æ¥å£æµ‹è¯•ï¼š</p>
<img src="%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae95678ee6a" alt="å›¾ç‰‡" / loading="lazy">



<h3 id="10ã€åç«¯æ€»ç»“"><a href="#10ã€åç«¯æ€»ç»“" class="headerlink" title="10ã€åç«¯æ€»ç»“"></a>10ã€åç«¯æ€»ç»“</h3><p>å¥½äº†ï¼Œä¸€ç¯‡æ–‡ç« æå®šä¸€ä¸ªåŸºæœ¬éª¨æ¶ï¼Œå¥½åƒæœ‰ç‚¹èµ¶ï¼Œä½†æ˜¯åŸºæœ¬çš„ä¸œè¥¿è¿™é‡Œå·²ç»æœ‰äº†ã€‚åé¢æˆ‘ä»¬å°±è¦å»å¼€å‘æˆ‘ä»¬çš„å‰ç«¯æ¥å£äº†ã€‚</p>
<p>é¡¹ç›®ä»£ç ï¼š<a target="_blank" rel="noopener" href="https://github.com/MarkerHub/vueblog">github.com/MarkerHub/vâ€¦</a></p>
<p>é¡¹ç›®è§†é¢‘ï¼š<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1PQ4y1P7hZ/">www.bilibili.com/video/BV1PQâ€¦</a></p>
<h2 id="Vueå‰ç«¯é¡µé¢å¼€å‘"><a href="#Vueå‰ç«¯é¡µé¢å¼€å‘" class="headerlink" title="Vueå‰ç«¯é¡µé¢å¼€å‘"></a>Vueå‰ç«¯é¡µé¢å¼€å‘</h2><h3 id="1ã€å‰è¨€-1"><a href="#1ã€å‰è¨€-1" class="headerlink" title="1ã€å‰è¨€"></a>1ã€å‰è¨€</h3><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥å®Œæˆvueblogå‰ç«¯çš„éƒ¨åˆ†åŠŸèƒ½ã€‚å¯èƒ½ä¼šä½¿ç”¨çš„åˆ°æŠ€æœ¯å¦‚ä¸‹ï¼š</p>
<ul>
<li>vue</li>
<li>element-ui</li>
<li>axios</li>
<li>mavon-editor</li>
<li>markdown-it</li>
<li>github-markdown-css</li>
</ul>
<p>æœ¬é¡¹ç›®å®è·µéœ€è¦ä¸€ç‚¹ç‚¹vueçš„åŸºç¡€ï¼Œå¸Œæœ›ä½ å¯¹vueçš„ä¸€äº›æŒ‡ä»¤æœ‰æ‰€äº†è§£ï¼Œè¿™æ ·æˆ‘ä»¬è®²è§£èµ·æ¥å°±ç®€å•å¤šäº†å“ˆã€‚</p>
<h3 id="2ã€é¡¹ç›®æ¼”ç¤º"><a href="#2ã€é¡¹ç›®æ¼”ç¤º" class="headerlink" title="2ã€é¡¹ç›®æ¼”ç¤º"></a>2ã€é¡¹ç›®æ¼”ç¤º</h3><p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹æˆ‘ä»¬éœ€è¦å®Œæˆçš„é¡¹ç›®é•¿ä»€ä¹ˆæ ·å­ï¼Œè€ƒè™‘åˆ°å¾ˆå¤šåŒå­¦çš„æ ·å¼çš„æŒæ¡ç¨‹åº¦ä¸å¤Ÿï¼Œæ‰€ä»¥æˆ‘å°½é‡ä½¿ç”¨äº†element-uiçš„åŸç”Ÿç»„ä»¶çš„æ ·å¼æ¥å®Œæˆæ•´ä¸ªåšå®¢çš„ç•Œé¢ã€‚ä¸å¤šè¯´ï¼Œç›´æ¥ä¸Šå›¾ï¼š</p>
<p>åœ¨çº¿ä½“éªŒï¼š<a target="_blank" rel="noopener" href="https://markerhub.com:8083/">markerhub.com:8083</a></p>
<img src="%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae952468938" alt="å›¾ç‰‡" style="zoom: 50%;" / loading="lazy">





<img src="%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae9568052ba" alt="å›¾ç‰‡" style="zoom: 67%;" / loading="lazy">





<img src="%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae961d9cee9" alt="å›¾ç‰‡" style="zoom:67%;" / loading="lazy">



<h3 id="3ã€ç¯å¢ƒå‡†å¤‡"><a href="#3ã€ç¯å¢ƒå‡†å¤‡" class="headerlink" title="3ã€ç¯å¢ƒå‡†å¤‡"></a>3ã€ç¯å¢ƒå‡†å¤‡</h3><p>ä¸‡ä¸ˆé«˜æ¥¼å¹³åœ°èµ·ï¼Œæˆ‘ä»¬ä¸‹é¢ä¸€æ­¥ä¸€æ­¥æ¥å®Œæˆï¼Œé¦–å…ˆæˆ‘ä»¬å®‰è£…vueçš„ç¯å¢ƒï¼Œæˆ‘å®è·µçš„ç¯å¢ƒæ˜¯windows 10å“ˆã€‚</p>
<p>1ã€é¦–å…ˆæˆ‘ä»¬ä¸Šnode.jså®˜ç½‘(<a target="_blank" rel="noopener" href="https://nodejs.org/zh-cn/">nodejs.org/zh-cn/</a>)ï¼Œä¸‹è½½æœ€æ–°çš„é•¿æœŸç‰ˆæœ¬ï¼Œç›´æ¥è¿è¡Œå®‰è£…å®Œæˆä¹‹åï¼Œæˆ‘ä»¬å°±å·²ç»å…·å¤‡äº†nodeå’Œnpmçš„ç¯å¢ƒå•¦ã€‚</p>
<img src="%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae97fe547a2" alt="å›¾ç‰‡" style="zoom: 33%;float:left" / loading="lazy">

<p>å®‰è£…å®Œæˆä¹‹åæ£€æŸ¥ä¸‹ç‰ˆæœ¬ä¿¡æ¯ï¼š</p>
<img src="%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae9801251e0" alt="å›¾ç‰‡" style="zoom:50%;float:left" / loading="lazy">

<p>2ã€æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å®‰è£…vueçš„ç¯å¢ƒ</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…æ·˜å®npm</span></span><br><span class="line"><span class="attr">npm</span> <span class="string">install -g cnpm --registry=https://registry.npm.taobao.org</span></span><br><span class="line"><span class="comment"># vue-cli å®‰è£…ä¾èµ–åŒ…</span></span><br><span class="line"><span class="attr">cnpm</span> <span class="string">install --g vue-cli</span></span><br></pre></td></tr></table></figure>

<h3 id="4ã€æ–°å»ºé¡¹ç›®"><a href="#4ã€æ–°å»ºé¡¹ç›®" class="headerlink" title="4ã€æ–°å»ºé¡¹ç›®"></a>4ã€æ–°å»ºé¡¹ç›®</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‰“å¼€vueçš„å¯è§†åŒ–ç®¡ç†å·¥å…·ç•Œé¢</span></span><br><span class="line"><span class="attr">vue</span> <span class="string">ui</span></span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢æˆ‘ä»¬åˆ†åˆ«å®‰è£…äº†æ·˜å®npmï¼Œcnpmæ˜¯ä¸ºäº†æé«˜æˆ‘ä»¬å®‰è£…ä¾èµ–çš„é€Ÿåº¦ã€‚vue uiæ˜¯@vue/cli3.0å¢åŠ ä¸€ä¸ªå¯è§†åŒ–é¡¹ç›®ç®¡ç†å·¥å…·ï¼Œå¯ä»¥è¿è¡Œé¡¹ç›®ã€æ‰“åŒ…é¡¹ç›®ï¼Œæ£€æŸ¥ç­‰æ“ä½œã€‚å¯¹äºåˆå­¦è€…æ¥è¯´ï¼Œå¯ä»¥å°‘è®°ä¸€äº›å‘½ä»¤ï¼Œå“ˆå“ˆã€‚ 3ã€åˆ›å»ºvueblog-vueé¡¹ç›®</p>
<p>è¿è¡Œvue uiä¹‹åï¼Œä¼šä¸ºæˆ‘ä»¬æ‰“å¼€ä¸€ä¸ª<a target="_blank" rel="noopener" href="http://localhost:8080/">http://localhost:8080</a> çš„é¡µé¢ï¼š</p>
<img src="%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae9870770cb" alt="å›¾ç‰‡" style="zoom:50%;" / loading="lazy">



<p>ç„¶ååˆ‡æ¢åˆ°ã€åˆ›å»ºã€‘ï¼Œæ³¨æ„åˆ›å»ºçš„ç›®å½•æœ€å¥½æ˜¯å’Œä½ è¿è¡Œvue uiåŒä¸€çº§ã€‚è¿™æ ·æ–¹ä¾¿ç®¡ç†å’Œåˆ‡æ¢ã€‚ç„¶åç‚¹å‡»æŒ‰é’®ã€åœ¨æ­¤åˆ›å»ºæ–°ç¾¡æ…•ã€‘</p>
<img src="%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae9988c77fc" alt="å›¾ç‰‡" style="zoom: 50%;" / loading="lazy">



<p>ä¸‹ä¸€æ­¥ä¸­ï¼Œé¡¹ç›®æ–‡ä»¶å¤¹ä¸­è¾“å…¥é¡¹ç›®åç§°â€œvueblog-vueâ€ï¼Œå…¶ä»–ä¸ç”¨æ”¹ï¼Œç‚¹å‡»ä¸‹ä¸€æ­¥ï¼Œé€‰æ‹©ã€æ‰‹åŠ¨ã€‘ï¼Œå†ç‚¹å‡»ä¸‹ä¸€æ­¥ï¼Œå¦‚å›¾ç‚¹å‡»æŒ‰é’®ï¼Œå‹¾é€‰ä¸Šè·¯ç”±Routerã€çŠ¶æ€ç®¡ç†Vuexï¼Œå»æ‰jsçš„æ ¡éªŒã€‚</p>
<img src="%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae9934c09b7" alt="å›¾ç‰‡" style="zoom:50%;" / loading="lazy">



<p>ä¸‹ä¸€æ­¥ä¸­ï¼Œä¹Ÿé€‰ä¸Šã€Use history mode for routerã€‘ï¼Œç‚¹å‡»åˆ›å»ºé¡¹ç›®ï¼Œç„¶åå¼¹çª—ä¸­é€‰æ‹©æŒ‰é’®ã€åˆ›å»ºé¡¹ç›®ï¼Œä¸ä¿å­˜é¢„è®¾ã€‘ï¼Œå°±è¿›å…¥é¡¹ç›®åˆ›å»ºå•¦ã€‚</p>
<p>ç¨ç­‰ç‰‡åˆ»ä¹‹åï¼Œé¡¹ç›®å°±åˆå§‹åŒ–å®Œæˆäº†ã€‚ä¸Šé¢çš„æ­¥éª¤ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªvueé¡¹ç›®ï¼Œå¹¶ä¸”å®‰è£…äº†Routerã€Vuexã€‚è¿™æ ·æˆ‘ä»¬åé¢å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚</p>
<p>æˆ‘ä»¬æ¥çœ‹ä¸‹æ•´ä¸ªvueblog-vueçš„é¡¹ç›®ç»“æ„</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">â”œâ”€â”€ README<span class="selector-class">.md</span>            é¡¹ç›®ä»‹ç»</span><br><span class="line">â”œâ”€â”€ index<span class="selector-class">.html</span>           å…¥å£é¡µé¢</span><br><span class="line">â”œâ”€â”€ build              æ„å»ºè„šæœ¬ç›®å½•</span><br><span class="line">â”‚  â”œâ”€â”€ build-server<span class="selector-class">.js</span>         è¿è¡Œæœ¬åœ°æ„å»ºæœåŠ¡å™¨ï¼Œå¯ä»¥è®¿é—®æ„å»ºåçš„é¡µé¢</span><br><span class="line">â”‚  â”œâ”€â”€ build<span class="selector-class">.js</span>            ç”Ÿäº§ç¯å¢ƒæ„å»ºè„šæœ¬</span><br><span class="line">â”‚  â”œâ”€â”€ dev-client<span class="selector-class">.js</span>          å¼€å‘æœåŠ¡å™¨çƒ­é‡è½½è„šæœ¬ï¼Œä¸»è¦ç”¨æ¥å®ç°å¼€å‘é˜¶æ®µçš„é¡µé¢è‡ªåŠ¨åˆ·æ–°</span><br><span class="line">â”‚  â”œâ”€â”€ dev-server<span class="selector-class">.js</span>          è¿è¡Œæœ¬åœ°å¼€å‘æœåŠ¡å™¨</span><br><span class="line">â”‚  â”œâ”€â”€ utils<span class="selector-class">.js</span>            æ„å»ºç›¸å…³å·¥å…·æ–¹æ³•</span><br><span class="line">â”‚  â”œâ”€â”€ webpack<span class="selector-class">.base</span><span class="selector-class">.conf</span><span class="selector-class">.js</span>      wabpackåŸºç¡€é…ç½®</span><br><span class="line">â”‚  â”œâ”€â”€ webpack<span class="selector-class">.dev</span><span class="selector-class">.conf</span><span class="selector-class">.js</span>       wabpackå¼€å‘ç¯å¢ƒé…ç½®</span><br><span class="line">â”‚  â””â”€â”€ webpack<span class="selector-class">.prod</span><span class="selector-class">.conf</span><span class="selector-class">.js</span>      wabpackç”Ÿäº§ç¯å¢ƒé…ç½®</span><br><span class="line">â”œâ”€â”€ config             é¡¹ç›®é…ç½®</span><br><span class="line">â”‚  â”œâ”€â”€ dev<span class="selector-class">.env</span><span class="selector-class">.js</span>           å¼€å‘ç¯å¢ƒå˜é‡</span><br><span class="line">â”‚  â”œâ”€â”€ index<span class="selector-class">.js</span>            é¡¹ç›®é…ç½®æ–‡ä»¶</span><br><span class="line">â”‚  â”œâ”€â”€ prod<span class="selector-class">.env</span><span class="selector-class">.js</span>           ç”Ÿäº§ç¯å¢ƒå˜é‡</span><br><span class="line">â”‚  â””â”€â”€ test<span class="selector-class">.env</span><span class="selector-class">.js</span>           æµ‹è¯•ç¯å¢ƒå˜é‡</span><br><span class="line">â”œâ”€â”€ mock              mockæ•°æ®ç›®å½•</span><br><span class="line">â”‚  â””â”€â”€ hello<span class="selector-class">.js</span></span><br><span class="line">â”œâ”€â”€ package<span class="selector-class">.json</span>          npmåŒ…é…ç½®æ–‡ä»¶ï¼Œé‡Œé¢å®šä¹‰äº†é¡¹ç›®çš„npmè„šæœ¬ï¼Œä¾èµ–åŒ…ç­‰ä¿¡æ¯</span><br><span class="line">â”œâ”€â”€ <span class="attribute">src</span>               æºç ç›®å½• </span><br><span class="line">â”‚  â”œâ”€â”€ <span class="selector-tag">main</span><span class="selector-class">.js</span>            å…¥å£jsæ–‡ä»¶</span><br><span class="line">â”‚  â”œâ”€â”€ components         å…¬å…±ç»„ä»¶ç›®å½•</span><br><span class="line">â”‚  â”‚  â””â”€â”€ title<span class="selector-class">.vue</span></span><br><span class="line">â”‚  â”œâ”€â”€ assets             èµ„æºç›®å½•ï¼Œè¿™é‡Œçš„èµ„æºä¼šè¢«wabpackæ„å»º</span><br><span class="line">â”‚  â”‚  â””â”€â”€ images</span><br><span class="line">â”‚  â”‚    â””â”€â”€ logo<span class="selector-class">.png</span></span><br><span class="line">â”‚  â”œâ”€â”€ routes             å‰ç«¯è·¯ç”±:è·³è½¬çš„url</span><br><span class="line">â”‚  â”‚  â””â”€â”€ index.js</span><br><span class="line">â”‚  â”œâ”€â”€ store              åº”ç”¨çº§æ•°æ®ï¼ˆstateï¼‰çŠ¶æ€ç®¡ç†</span><br><span class="line">â”‚  â”‚  â””â”€â”€ index.js</span><br><span class="line">â”‚  â”œâ”€â”€ app.vue ---------- æ ¹ç»„ä»¶:é¡µé¢ä¸å˜åŒ–çš„ç»„ä»¶</span><br><span class="line">â”‚  â””â”€â”€ views ------------ é¡µé¢ç›®å½•:é¡µé¢å˜åŒ–çš„ç»„ä»¶</span><br><span class="line">â”‚    â”œâ”€â”€ hello.vue</span><br><span class="line">â”‚    â””â”€â”€ notfound.vue</span><br><span class="line">â”œâ”€â”€ static             çº¯é™æ€èµ„æºï¼Œä¸ä¼šè¢«wabpackæ„å»ºã€‚</span><br><span class="line">â””â”€â”€ test              æµ‹è¯•æ–‡ä»¶ç›®å½•ï¼ˆunit&amp;e2eï¼‰</span><br><span class="line">  â””â”€â”€ unit              å•å…ƒæµ‹è¯•</span><br><span class="line">    â”œâ”€â”€ index.js            å…¥å£è„šæœ¬</span><br><span class="line">    â”œâ”€â”€ karma.conf.js          karmaé…ç½®æ–‡ä»¶</span><br><span class="line">    â””â”€â”€ specs              å•æµ‹caseç›®å½•</span><br><span class="line">      â””â”€â”€ Hello.spec.js</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="5ã€å®‰è£…element-ui"><a href="#5ã€å®‰è£…element-ui" class="headerlink" title="5ã€å®‰è£…element-ui"></a>5ã€å®‰è£…element-ui</h3><p>æ¥ä¸‹æ¥æˆ‘ä»¬å¼•å…¥element-uiç»„ä»¶ï¼ˆ<a target="_blank" rel="noopener" href="https://element.eleme.cn/#/zh-CN/component/installation">element.eleme.cn</a>ï¼‰ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è·å¾—å¥½çœ‹çš„vueç»„ä»¶ï¼Œå¼€å‘å¥½çœ‹çš„åšå®¢ç•Œé¢ã€‚</p>
<p><img src="%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae9b6f2f82a" alt="å›¾ç‰‡" loading="lazy"></p>
<p>å‘½ä»¤å¾ˆç®€å•ï¼š</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ‡æ¢åˆ°é¡¹ç›®æ ¹ç›®å½•</span></span><br><span class="line"><span class="attr">cd</span> <span class="string">vueblog-vue</span></span><br><span class="line"><span class="comment"># å®‰è£…element-ui</span></span><br><span class="line"><span class="attr">cnpm</span> <span class="string">install element-ui --save</span></span><br></pre></td></tr></table></figure>

<p>ç„¶åæˆ‘ä»¬æ‰“å¼€é¡¹ç›®srcç›®å½•ä¸‹çš„main.jsï¼Œå¼•å…¥element-uiä¾èµ–ã€‚</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import Element <span class="selector-tag">from</span> &#x27;element-ui&#x27;</span><br><span class="line">import &quot;element-ui/lib/theme-chalk/index<span class="selector-class">.css</span>&quot;</span><br><span class="line">Vue<span class="selector-class">.use</span>(Element)</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ„‰å¿«å¾—åœ¨å®˜ç½‘ä¸Šé€‰æ‹©ç»„ä»¶åˆ°æˆ‘ä»¬é¡¹ç›®ä¸­ç›´æ¥ä½¿ç”¨å•¦ã€‚</p>
<h3 id="6ã€å®‰è£…axios"><a href="#6ã€å®‰è£…axios" class="headerlink" title="6ã€å®‰è£…axios"></a>6ã€å®‰è£…axios</h3><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥å®‰è£…axiosï¼ˆ<a target="_blank" rel="noopener" href="http://www.axios-js.com/">www.axios-js.com/</a>ï¼‰ï¼Œaxiosæ˜¯ä¸€ä¸ªåŸºäº promise çš„ HTTP åº“ï¼Œè¿™æ ·æˆ‘ä»¬è¿›è¡Œå‰åç«¯å¯¹æ¥çš„æ—¶å€™ï¼Œä½¿ç”¨è¿™ä¸ªå·¥å…·å¯ä»¥æé«˜æˆ‘ä»¬çš„å¼€å‘æ•ˆç‡ã€‚</p>
<p>å®‰è£…å‘½ä»¤ï¼š</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm install axios --save</span><br></pre></td></tr></table></figure>

<p>ç„¶ååŒæ ·æˆ‘ä»¬åœ¨main.jsä¸­å…¨å±€å¼•å…¥axiosã€‚</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import axios <span class="selector-tag">from</span> &#x27;axios&#x27;</span><br><span class="line">Vue<span class="selector-class">.prototype</span>.$axios = axios //</span><br></pre></td></tr></table></figure>

<p>ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡this.$axios.get()æ¥å‘èµ·æˆ‘ä»¬çš„è¯·æ±‚äº†å“ˆã€‚</p>
<h3 id="7ã€é¡µé¢è·¯ç”±"><a href="#7ã€é¡µé¢è·¯ç”±" class="headerlink" title="7ã€é¡µé¢è·¯ç”±"></a>7ã€é¡µé¢è·¯ç”±</h3><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å…ˆå®šä¹‰å¥½è·¯ç”±å’Œé¡µé¢ï¼Œå› ä¸ºæˆ‘ä»¬åªæ˜¯åšä¸€ä¸ªç®€å•çš„åšå®¢é¡¹ç›®ï¼Œé¡µé¢æ¯”è¾ƒå°‘ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥å…ˆå®šä¹‰å¥½ï¼Œç„¶ååœ¨æ…¢æ…¢å¼€å‘ï¼Œè¿™æ ·éœ€è¦ç”¨åˆ°é“¾æ¥çš„åœ°æ–¹æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥å¯ä»¥ä½¿ç”¨ï¼š</p>
<p>æˆ‘ä»¬åœ¨viewsæ–‡ä»¶å¤¹ä¸‹å®šä¹‰å‡ ä¸ªé¡µé¢ï¼š</p>
<ul>
<li>BlogDetail.vueï¼ˆåšå®¢è¯¦æƒ…é¡µï¼‰</li>
<li>BlogEdit.vueï¼ˆç¼–è¾‘åšå®¢ï¼‰</li>
<li>Blogs.vueï¼ˆåšå®¢åˆ—è¡¨ï¼‰</li>
<li>Login.vueï¼ˆç™»å½•é¡µé¢ï¼‰</li>
</ul>
<p>ç„¶åå†è·¯ç”±ä¸­å¿ƒé…ç½®ï¼š</p>
<ul>
<li>router\index.js</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import Vue <span class="selector-tag">from</span> &#x27;vue&#x27;</span><br><span class="line">import VueRouter <span class="selector-tag">from</span> &#x27;vue-router&#x27;</span><br><span class="line">import Login <span class="selector-tag">from</span> &#x27;../views/Login<span class="selector-class">.vue</span>&#x27;</span><br><span class="line">import BlogDetail <span class="selector-tag">from</span> &#x27;../views/BlogDetail<span class="selector-class">.vue</span>&#x27;</span><br><span class="line">import BlogEdit <span class="selector-tag">from</span> &#x27;../views/BlogEdit<span class="selector-class">.vue</span>&#x27;</span><br><span class="line">Vue<span class="selector-class">.use</span>(VueRouter)</span><br><span class="line">const routes = <span class="selector-attr">[  &#123;    path: <span class="string">&#x27;/&#x27;</span>,    name: <span class="string">&#x27;Index&#x27;</span>,    redirect: &#123; name: <span class="string">&#x27;Blogs&#x27;</span> &#125;  &#125;,  &#123;    path: <span class="string">&#x27;/login&#x27;</span>,    name: <span class="string">&#x27;Login&#x27;</span>,    component: Login  &#125;,  &#123;    path: <span class="string">&#x27;/blogs&#x27;</span>,    name: <span class="string">&#x27;Blogs&#x27;</span>,    // æ‡’åŠ è½½    component: () =&gt; import(<span class="string">&#x27;../views/Blogs.vue&#x27;</span>)  &#125;,  &#123;    path: <span class="string">&#x27;/blog/add&#x27;</span>, // æ³¨æ„æ”¾åœ¨ path: <span class="string">&#x27;/blog/:blogId&#x27;</span>ä¹‹å‰    name: <span class="string">&#x27;BlogAdd&#x27;</span>,    meta: &#123;      requireAuth: true    &#125;,    component: BlogEdit  &#125;,  &#123;    path: <span class="string">&#x27;/blog/:blogId&#x27;</span>,    name: <span class="string">&#x27;BlogDetail&#x27;</span>,    component: BlogDetail  &#125;,  &#123;    path: <span class="string">&#x27;/blog/:blogId/edit&#x27;</span>,    name: <span class="string">&#x27;BlogEdit&#x27;</span>,    meta: &#123;      requireAuth: true    &#125;,    component: BlogEdit  &#125;]</span>;</span><br><span class="line">const router = new VueRouter(&#123;</span><br><span class="line">  mode: <span class="string">&#x27;history&#x27;</span>,</span><br><span class="line">  base: process.env.BASE_URL,</span><br><span class="line">  routes</span><br><span class="line">&#125;)</span><br><span class="line">export default router</span><br></pre></td></tr></table></figure>

<p>æ¥ä¸‹æ¥æˆ‘ä»¬å»å¼€å‘æˆ‘ä»¬çš„é¡µé¢ã€‚å…¶ä¸­ï¼Œå¸¦æœ‰metaï¼šrequireAuth: trueè¯´æ˜æ˜¯éœ€è¦ç™»å½•å­—åæ‰èƒ½è®¿é—®çš„å—é™èµ„æºï¼Œåé¢æˆ‘ä»¬è·¯ç”±æƒé™æ‹¦æˆªæ—¶å€™ä¼šç”¨åˆ°ã€‚</p>
<h3 id="8ã€ç™»å½•é¡µé¢"><a href="#8ã€ç™»å½•é¡µé¢" class="headerlink" title="8ã€ç™»å½•é¡µé¢"></a>8ã€ç™»å½•é¡µé¢</h3><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥æä¸€ä¸ªç™»é™†é¡µé¢ï¼Œè¡¨å•ç»„ä»¶æˆ‘ä»¬ç›´æ¥åœ¨element-uiçš„å®˜ç½‘ä¸Šæ‰¾å°±è¡Œäº†ï¼Œç™»é™†é¡µé¢å°±ä¸¤ä¸ªè¾“å…¥æ¡†å’Œä¸€ä¸ªæäº¤æŒ‰é’®ï¼Œç›¸å¯¹ç®€å•ï¼Œç„¶åæˆ‘ä»¬æœ€å¥½å¸¦é¡µé¢çš„jsæ ¡éªŒã€‚emmmï¼Œæˆ‘ç›´æ¥è´´ä»£ç äº†~~</p>
<ul>
<li>views/Login.vue</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;<span class="selector-tag">div</span>&gt;</span><br><span class="line">    &lt;el-container&gt;</span><br><span class="line">      &lt;el-<span class="selector-tag">header</span>&gt;</span><br><span class="line">        &lt;router-link <span class="selector-tag">to</span>=&quot;/blogs&quot;&gt;</span><br><span class="line">        &lt;<span class="selector-tag">img</span> <span class="attribute">src</span>=&quot;https://www.markerhub.com/dist/images/logo/markerhub-logo.png<span class="string">&quot;</span></span><br><span class="line"><span class="string">             style=&quot;</span>height: <span class="number">60%</span>; <span class="attribute">margin-top</span>: <span class="number">10px</span>;&quot;&gt;</span><br><span class="line">        &lt;/router-link&gt;</span><br><span class="line">      &lt;/el-<span class="selector-tag">header</span>&gt;</span><br><span class="line">      &lt;el-<span class="selector-tag">main</span>&gt;</span><br><span class="line">        &lt;el-<span class="selector-tag">form</span> :model=<span class="string">&quot;ruleForm&quot;</span> status-icon :rules=<span class="string">&quot;rules&quot;</span> ref=<span class="string">&quot;ruleForm&quot;</span> label-width=<span class="string">&quot;100px&quot;</span></span><br><span class="line">                 class=<span class="string">&quot;demo-ruleForm&quot;</span>&gt;</span><br><span class="line">          &lt;el-form-item label=<span class="string">&quot;ç”¨æˆ·å&quot;</span> prop=<span class="string">&quot;username&quot;</span>&gt;</span><br><span class="line">            &lt;el-input type=<span class="string">&quot;text&quot;</span> maxlength=<span class="string">&quot;12&quot;</span> v-model=<span class="string">&quot;ruleForm.username&quot;</span>&gt;&lt;/el-input&gt;</span><br><span class="line">          &lt;/el-form-item&gt;</span><br><span class="line">          &lt;el-form-item label=<span class="string">&quot;å¯†ç &quot;</span> prop=<span class="string">&quot;password&quot;</span>&gt;</span><br><span class="line">            &lt;el-input type=<span class="string">&quot;password&quot;</span> v-model=<span class="string">&quot;ruleForm.password&quot;</span> autocomplete=<span class="string">&quot;off&quot;</span>&gt;&lt;/el-input&gt;</span><br><span class="line">          &lt;/el-form-item&gt;</span><br><span class="line">          &lt;el-form-item&gt;</span><br><span class="line">            &lt;el-button type=<span class="string">&quot;primary&quot;</span> @click=<span class="string">&quot;submitForm(&#x27;ruleForm&#x27;)&quot;</span>&gt;ç™»å½•&lt;/el-button&gt;</span><br><span class="line">            &lt;el-button @click=<span class="string">&quot;resetForm(&#x27;ruleForm&#x27;)&quot;</span>&gt;é‡ç½®&lt;/el-button&gt;</span><br><span class="line">          &lt;/el-form-item&gt;</span><br><span class="line">        &lt;/el-form&gt;</span><br><span class="line">      &lt;/el-main&gt;</span><br><span class="line">    &lt;/el-container&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">  export default &#123;</span><br><span class="line">    name: <span class="string">&#x27;Login&#x27;</span>,</span><br><span class="line">    <span class="built_in">data</span>() &#123;</span><br><span class="line">      var validatePass = (rule, value, callback) =&gt; &#123;</span><br><span class="line">        if (value === <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">          <span class="built_in">callback</span>(new <span class="built_in">Error</span>(<span class="string">&#x27;è¯·è¾“å…¥å¯†ç &#x27;</span>));</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">          callback();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line">      return &#123;</span><br><span class="line">        ruleForm: &#123;</span><br><span class="line">          password: <span class="string">&#x27;111111&#x27;</span>,</span><br><span class="line">          username: <span class="string">&#x27;markerhub&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        rules: &#123;</span><br><span class="line">          password: [</span><br><span class="line">            &#123;validator: validatePass, trigger: <span class="string">&#x27;blur&#x27;</span>&#125;</span><br><span class="line">          ],</span><br><span class="line">          username: [</span><br><span class="line">            &#123;required: true, message: <span class="string">&#x27;è¯·è¾“å…¥ç”¨æˆ·å&#x27;</span>, trigger: <span class="string">&#x27;blur&#x27;</span>&#125;,</span><br><span class="line">            &#123;min: <span class="number">3</span>, max: <span class="number">12</span>, message: <span class="string">&#x27;é•¿åº¦åœ¨ 3 åˆ° 12 ä¸ªå­—ç¬¦&#x27;</span>, trigger: <span class="string">&#x27;blur&#x27;</span>&#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">      <span class="built_in">submitForm</span>(formName) &#123;</span><br><span class="line">        const _this = this</span><br><span class="line">        this.$refs[formName].<span class="built_in">validate</span>((valid) =&gt; &#123;</span><br><span class="line">          if (valid) &#123;</span><br><span class="line">            // æäº¤é€»è¾‘</span><br><span class="line">            this.$axios.<span class="built_in">post</span>(<span class="string">&#x27;http://localhost:8081/login&#x27;</span>, this.ruleForm).<span class="built_in">then</span>((res)=&gt;&#123;</span><br><span class="line">              const token = res.headers[<span class="string">&#x27;authorization&#x27;</span>]</span><br><span class="line">              _this.$store.<span class="built_in">commit</span>(<span class="string">&#x27;SET_TOKEN&#x27;</span>, token)</span><br><span class="line">              _this.$store.<span class="built_in">commit</span>(<span class="string">&#x27;SET_USERINFO&#x27;</span>, res.data.data)</span><br><span class="line">              _this.$router.<span class="built_in">push</span>(<span class="string">&quot;/blogs&quot;</span>)</span><br><span class="line">            &#125;)</span><br><span class="line">          &#125; else &#123;</span><br><span class="line">            console<span class="selector-class">.log</span>(&#x27;error submit!!&#x27;);</span><br><span class="line">            return false;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;,</span><br><span class="line">      resetForm(formName) &#123;</span><br><span class="line">        this.$refs<span class="selector-attr">[formName]</span><span class="selector-class">.resetFields</span>();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    mounted() &#123;</span><br><span class="line">      this.$notify(&#123;</span><br><span class="line">        title: <span class="string">&#x27;çœ‹è¿™é‡Œï¼š&#x27;</span>,</span><br><span class="line">        message: <span class="string">&#x27;å…³æ³¨å…¬ä¼—å·ï¼šMarkerHubï¼Œå›å¤ã€vueblogã€‘ï¼Œé¢†å–é¡¹ç›®èµ„æ–™ä¸æºç &#x27;</span>,</span><br><span class="line">        duration: <span class="number">1500</span></span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>æ‰¾ä¸åˆ°å•¥å¥½çš„æ–¹å¼è®²è§£äº†ï¼Œä¹‹åå…ˆè´´ä»£ç ï¼Œç„¶åå†è®²è§£ã€‚ ä¸Šé¢ä»£ç ä¸­ï¼Œå…¶å®ä¸»è¦åšäº†ä¸¤ä»¶äº‹æƒ…</p>
<p>1ã€è¡¨å•æ ¡éªŒ</p>
<p>2ã€ç™»å½•æŒ‰é’®çš„ç‚¹å‡»ç™»å½•äº‹ä»¶</p>
<p>è¡¨å•æ ¡éªŒè§„åˆ™è¿˜å¥½ï¼Œæ¯”è¾ƒå›ºå®šå†™æ³•ï¼ŒæŸ¥ä¸€ä¸‹element-uiçš„ç»„ä»¶å°±çŸ¥é“äº†ï¼Œæˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹å‘èµ·ç™»å½•ä¹‹åçš„ä»£ç ï¼š</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">const token = res<span class="selector-class">.headers</span><span class="selector-attr">[<span class="string">&#x27;authorization&#x27;</span>]</span></span><br><span class="line">_this.$store<span class="selector-class">.commit</span>(&#x27;SET_TOKEN&#x27;, token)</span><br><span class="line">_this.$store<span class="selector-class">.commit</span>(&#x27;SET_USERINFO&#x27;, res<span class="selector-class">.data</span><span class="selector-class">.data</span>)</span><br><span class="line">_this.$router<span class="selector-class">.push</span>(&quot;/blogs&quot;)</span><br></pre></td></tr></table></figure>

<p>ä»è¿”å›çš„ç»“æœè¯·æ±‚å¤´ä¸­è·å–åˆ°tokençš„ä¿¡æ¯ï¼Œç„¶åä½¿ç”¨storeæäº¤tokenå’Œç”¨æˆ·ä¿¡æ¯çš„çŠ¶æ€ã€‚å®Œæˆæ“ä½œä¹‹åï¼Œæˆ‘ä»¬è°ƒæ•´åˆ°äº†/blogsè·¯ç”±ï¼Œå³åšå®¢åˆ—è¡¨é¡µé¢ã€‚</p>
<h4 id="tokençš„çŠ¶æ€åŒæ­¥"><a href="#tokençš„çŠ¶æ€åŒæ­¥" class="headerlink" title="tokençš„çŠ¶æ€åŒæ­¥"></a>tokençš„çŠ¶æ€åŒæ­¥</h4><p>æ‰€ä»¥åœ¨store/index.jsä¸­ï¼Œä»£ç æ˜¯è¿™æ ·çš„ï¼š</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">import Vue <span class="selector-tag">from</span> &#x27;vue&#x27;</span><br><span class="line">import Vuex <span class="selector-tag">from</span> &#x27;vuex&#x27;</span><br><span class="line">Vue<span class="selector-class">.use</span>(Vuex)</span><br><span class="line">export default new Vuex<span class="selector-class">.Store</span>(&#123;</span><br><span class="line">  state: &#123;</span><br><span class="line">    token: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    userInfo: JSON.<span class="built_in">parse</span>(sessionStorage.<span class="built_in">getItem</span>(<span class="string">&quot;userInfo&quot;</span>))</span><br><span class="line">  &#125;,</span><br><span class="line">  mutations: &#123;</span><br><span class="line">    SET_TOKEN: (state, token) =&gt; &#123;</span><br><span class="line">      state.token = token</span><br><span class="line">      localStorage.<span class="built_in">setItem</span>(<span class="string">&quot;token&quot;</span>, token)</span><br><span class="line">    &#125;,</span><br><span class="line">    SET_USERINFO: (state, userInfo) =&gt; &#123;</span><br><span class="line">      state.userInfo = userInfo</span><br><span class="line">      sessionStorage.<span class="built_in">setItem</span>(<span class="string">&quot;userInfo&quot;</span>, JSON.<span class="built_in">stringify</span>(userInfo))</span><br><span class="line">    &#125;,</span><br><span class="line">    REMOVE_INFO: (state) =&gt; &#123;</span><br><span class="line">      localStorage.<span class="built_in">setItem</span>(<span class="string">&quot;token&quot;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">      sessionStorage.<span class="built_in">setItem</span>(<span class="string">&quot;userInfo&quot;</span>, JSON.<span class="built_in">stringify</span>(<span class="string">&#x27;&#x27;</span>))</span><br><span class="line">      state.userInfo = &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  getters: &#123;</span><br><span class="line">    getUser: state =&gt; &#123;</span><br><span class="line">      return state.userInfo</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  actions: &#123;&#125;,</span><br><span class="line">  modules: &#123;&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>å­˜å‚¨tokenï¼Œæˆ‘ä»¬ç”¨çš„æ˜¯localStorageï¼Œå­˜å‚¨ç”¨æˆ·ä¿¡æ¯ï¼Œæˆ‘ä»¬ç”¨çš„æ˜¯sessionStorageã€‚æ¯•ç«Ÿç”¨æˆ·ä¿¡æ¯æˆ‘ä»¬ä¸éœ€è¦é•¿ä¹…ä¿å­˜ï¼Œä¿å­˜äº†tokenä¿¡æ¯ï¼Œæˆ‘ä»¬éšæ—¶éƒ½å¯ä»¥åˆå§‹åŒ–ç”¨æˆ·ä¿¡æ¯ã€‚å½“ç„¶äº†å› ä¸ºæœ¬é¡¹ç›®æ˜¯ä¸ªæ¯”è¾ƒç®€å•çš„é¡¹ç›®ï¼Œè€ƒè™‘åˆ°åˆå­¦è€…ï¼Œæ‰€ä»¥å¾ˆå¤šç›¸å¯¹å¤æ‚çš„å°è£…å’ŒåŠŸèƒ½æˆ‘æ²¡æœ‰åšï¼Œå½“ç„¶äº†ï¼Œå­¦äº†è¿™ä¸ªé¡¹ç›®ä¹‹åï¼Œè‡ªå·±æƒ³å†ç»§ç»­æ·±å…¥ï¼Œå®Œæˆå¯ä»¥è‡ªè¡Œå­¦ä¹ å’Œæ”¹é€ å“ˆã€‚</p>
<h4 id="å®šä¹‰å…¨å±€axiosæ‹¦æˆªå™¨"><a href="#å®šä¹‰å…¨å±€axiosæ‹¦æˆªå™¨" class="headerlink" title="å®šä¹‰å…¨å±€axiosæ‹¦æˆªå™¨"></a>å®šä¹‰å…¨å±€axiosæ‹¦æˆªå™¨</h4><p>ç‚¹å‡»ç™»å½•æŒ‰é’®å‘èµ·ç™»å½•è¯·æ±‚ï¼ŒæˆåŠŸæ—¶å€™è¿”å›äº†æ•°æ®ï¼Œå¦‚æœæ˜¯å¯†ç é”™è¯¯ï¼Œæˆ‘ä»¬æ˜¯ä¸æ˜¯ä¹Ÿåº”è¯¥å¼¹çª—æ¶ˆæ¯æç¤ºã€‚ä¸ºäº†è®©è¿™ä¸ªé”™è¯¯å¼¹çª—èƒ½è¿ç”¨åˆ°æ‰€æœ‰çš„åœ°æ–¹ï¼Œæ‰€ä»¥æˆ‘å¯¹axiosåšäº†ä¸ªåç½®æ‹¦æˆªå™¨ï¼Œå°±æ˜¯è¿”å›æ•°æ®æ—¶å€™ï¼Œå¦‚æœç»“æœçš„codeæˆ–è€…statusä¸æ­£å¸¸ï¼Œé‚£ä¹ˆæˆ‘å¯¹åº”å¼¹çª—æç¤ºã€‚</p>
<p>åœ¨srcç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–‡ä»¶axios.jsï¼ˆä¸main.jsåŒçº§ï¼‰ï¼Œå®šä¹‰axiosçš„æ‹¦æˆªï¼š</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">import axios <span class="selector-tag">from</span> &#x27;axios&#x27;</span><br><span class="line">import Element <span class="selector-tag">from</span> &quot;element-ui&quot;;</span><br><span class="line">import store <span class="selector-tag">from</span> &quot;./store&quot;;</span><br><span class="line">import router <span class="selector-tag">from</span> &quot;./router&quot;;</span><br><span class="line">axios<span class="selector-class">.defaults</span><span class="selector-class">.baseURL</span>=&#x27;http://localhost:<span class="number">8081</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">axios.interceptors.request.use(config =&gt; &#123;</span></span><br><span class="line"><span class="string">  console.log(&quot;å‰ç½®æ‹¦æˆª&quot;)</span></span><br><span class="line"><span class="string">  // å¯ä»¥ç»Ÿä¸€è®¾ç½®è¯·æ±‚å¤´</span></span><br><span class="line"><span class="string">  return config</span></span><br><span class="line"><span class="string">&#125;)</span></span><br><span class="line"><span class="string">axios.interceptors.response.use(response =&gt; &#123;</span></span><br><span class="line"><span class="string">    const res = response.data;</span></span><br><span class="line"><span class="string">    console.log(&quot;åç½®æ‹¦æˆª&quot;)</span></span><br><span class="line"><span class="string">    // å½“ç»“æœçš„codeæ˜¯å¦ä¸º200çš„æƒ…å†µ</span></span><br><span class="line"><span class="string">    if (res.code === 200) &#123;</span></span><br><span class="line"><span class="string">      return response</span></span><br><span class="line"><span class="string">    &#125; else &#123;</span></span><br><span class="line"><span class="string">      // å¼¹çª—å¼‚å¸¸ä¿¡æ¯</span></span><br><span class="line"><span class="string">      Element.Message(&#123;</span></span><br><span class="line"><span class="string">        message: response.data.msg,</span></span><br><span class="line"><span class="string">        type: &#x27;</span>error<span class="string">&#x27;,</span></span><br><span class="line"><span class="string">        duration: 2 * 1000</span></span><br><span class="line"><span class="string">      &#125;)</span></span><br><span class="line"><span class="string">      // ç›´æ¥æ‹’ç»å¾€ä¸‹é¢è¿”å›ç»“æœä¿¡æ¯</span></span><br><span class="line"><span class="string">      return Promise.reject(response.data.msg)</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;,</span></span><br><span class="line"><span class="string">  error =&gt; &#123;</span></span><br><span class="line"><span class="string">    console.log(&#x27;</span>err<span class="string">&#x27; + error)// for debug</span></span><br><span class="line"><span class="string">    if(error.response.data) &#123;</span></span><br><span class="line"><span class="string">      error.message = error.response.data.msg</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    // æ ¹æ®è¯·æ±‚çŠ¶æ€è§‰å¾—æ˜¯å¦ç™»å½•æˆ–è€…æç¤ºå…¶ä»–</span></span><br><span class="line"><span class="string">    if (error.response.status === 401) &#123;</span></span><br><span class="line"><span class="string">      store.commit(&#x27;</span>REMOVE_INFO<span class="string">&#x27;);</span></span><br><span class="line"><span class="string">      router.push(&#123;</span></span><br><span class="line"><span class="string">        path: &#x27;</span>/login<span class="string">&#x27;</span></span><br><span class="line"><span class="string">      &#125;);</span></span><br><span class="line"><span class="string">      error.message = &#x27;</span>è¯·é‡æ–°ç™»å½•<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    if (error.response.status === 403) &#123;</span></span><br><span class="line"><span class="string">      error.message = &#x27;</span>æƒé™ä¸è¶³ï¼Œæ— æ³•è®¿é—®<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    Element.Message(&#123;</span></span><br><span class="line"><span class="string">      message: error.message,</span></span><br><span class="line"><span class="string">      type: &#x27;</span>error<span class="string">&#x27;,</span></span><br><span class="line"><span class="string">      duration: 3 * 1000</span></span><br><span class="line"><span class="string">    &#125;)</span></span><br><span class="line"><span class="string">    return Promise.reject(error)</span></span><br><span class="line"><span class="string">  &#125;)</span></span><br></pre></td></tr></table></figure>

<p>å‰ç½®æ‹¦æˆªï¼Œå…¶å®å¯ä»¥ç»Ÿä¸€ä¸ºæ‰€æœ‰éœ€è¦æƒé™çš„è¯·æ±‚è£…é…ä¸Šheaderçš„tokenä¿¡æ¯ï¼Œè¿™æ ·ä¸éœ€è¦åœ¨ä½¿ç”¨æ˜¯å†é…ç½®ï¼Œæˆ‘çš„å°é¡¹ç›®æ¯”è¾ƒå°ï¼Œæ‰€ä»¥ï¼Œè¿˜æ˜¯å…äº†å§~</p>
<p>ç„¶åå†main.jsä¸­å¯¼å…¥axios.js</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import &#x27;./axios.js&#x27; // è¯·æ±‚æ‹¦æˆª</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>åç«¯å› ä¸ºè¿”å›çš„å®ä½“æ˜¯Resultï¼Œsuccæ—¶å€™codeä¸º200ï¼Œfailæ—¶å€™è¿”å›çš„æ˜¯400ï¼Œæ‰€ä»¥å¯ä»¥æ ¹æ®è¿™é‡Œåˆ¤æ–­ç»“æœæ˜¯å¦æ˜¯æ­£å¸¸çš„ã€‚å¦å¤–æƒé™ä¸è¶³æ—¶å€™å¯ä»¥é€šè¿‡è¯·æ±‚ç»“æœçš„çŠ¶æ€ç æ¥åˆ¤æ–­ç»“æœæ˜¯å¦æ­£å¸¸ã€‚è¿™é‡Œéƒ½åšäº†ç®€å•çš„å¤„ç†ã€‚</p>
<p>ç™»å½•å¼‚å¸¸æ—¶å€™çš„æ•ˆæœå¦‚ä¸‹ï¼š</p>
<img src="%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae9c0da7a02" alt="å›¾ç‰‡" style="zoom: 67%;" / loading="lazy">



<h3 id="9ã€åšå®¢åˆ—è¡¨"><a href="#9ã€åšå®¢åˆ—è¡¨" class="headerlink" title="9ã€åšå®¢åˆ—è¡¨"></a>9ã€åšå®¢åˆ—è¡¨</h3><p>ç™»å½•å®Œæˆä¹‹åç›´æ¥è¿›å…¥åšå®¢åˆ—è¡¨é¡µé¢ï¼Œç„¶ååŠ è½½åšå®¢åˆ—è¡¨çš„æ•°æ®æ¸²æŸ“å‡ºæ¥ã€‚åŒæ—¶é¡µé¢å¤´éƒ¨æˆ‘ä»¬éœ€è¦æŠŠç”¨æˆ·çš„ä¿¡æ¯å±•ç¤ºå‡ºæ¥ï¼Œå› ä¸ºå¾ˆå¤šåœ°æ–¹éƒ½ç”¨åˆ°è¿™ä¸ªæ¨¡å—ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠé¡µé¢å¤´éƒ¨çš„ç”¨æˆ·ä¿¡æ¯å•ç‹¬æŠ½å–å‡ºæ¥ä½œä¸ºä¸€ä¸ªç»„ä»¶ã€‚</p>
<h4 id="å¤´éƒ¨ç”¨æˆ·ä¿¡æ¯"><a href="#å¤´éƒ¨ç”¨æˆ·ä¿¡æ¯" class="headerlink" title="å¤´éƒ¨ç”¨æˆ·ä¿¡æ¯"></a>å¤´éƒ¨ç”¨æˆ·ä¿¡æ¯</h4><p>é‚£ä¹ˆï¼Œæˆ‘ä»¬å…ˆæ¥å®Œæˆå¤´éƒ¨çš„ç”¨æˆ·ä¿¡æ¯ï¼Œåº”è¯¥åŒ…å«ä¸‰éƒ¨åˆ†ä¿¡æ¯ï¼šidï¼Œå¤´åƒã€ç”¨æˆ·åï¼Œè€Œè¿™äº›ä¿¡æ¯æˆ‘ä»¬æ˜¯åœ¨ç™»å½•ä¹‹åå°±å·²ç»å­˜åœ¨äº†sessionStorageã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡storeçš„gettersè·å–åˆ°ç”¨æˆ·ä¿¡æ¯ã€‚</p>
<img src="%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae9c4c440a3" alt="å›¾ç‰‡" style="zoom: 80%;" / loading="lazy">



<p>çœ‹èµ·æ¥ä¸æ˜¯å¾ˆå¤æ‚ï¼Œæˆ‘ä»¬è´´å‡ºä»£ç ï¼š</p>
<ul>
<li>components\Header.vue</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;m-content&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>æ¬¢è¿æ¥åˆ°MarkerHubçš„åšå®¢<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;block&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-avatar</span> <span class="attr">:size</span>=<span class="string">&quot;50&quot;</span> <span class="attr">:src</span>=<span class="string">&quot;user.avatar&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-avatar</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123; user.username &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;maction&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-link</span> <span class="attr">href</span>=<span class="string">&quot;/blogs&quot;</span>&gt;</span>ä¸»é¡µ<span class="tag">&lt;/<span class="name">el-link</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-divider</span> <span class="attr">direction</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-divider</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-link</span> <span class="attr">type</span>=<span class="string">&quot;success&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/blog/add&quot;</span> <span class="attr">:disabled</span>=<span class="string">&quot;!hasLogin&quot;</span>&gt;</span>å‘è¡¨æ–‡ç« <span class="tag">&lt;/<span class="name">el-link</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-divider</span> <span class="attr">direction</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-divider</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">v-show</span>=<span class="string">&quot;!hasLogin&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-link</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/login&quot;</span>&gt;</span>ç™»é™†<span class="tag">&lt;/<span class="name">el-link</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">v-show</span>=<span class="string">&quot;hasLogin&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-link</span> <span class="attr">type</span>=<span class="string">&quot;danger&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;logout&quot;</span>&gt;</span>é€€å‡º<span class="tag">&lt;/<span class="name">el-link</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="attr">name</span>: <span class="string">&quot;Header&quot;</span>,</span></span><br><span class="line"><span class="javascript">    <span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="attr">hasLogin</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="javascript">        <span class="attr">user</span>: &#123;</span></span><br><span class="line"><span class="javascript">          <span class="attr">username</span>: <span class="string">&#x27;è¯·å…ˆç™»å½•&#x27;</span>,</span></span><br><span class="line"><span class="javascript">          <span class="attr">avatar</span>: <span class="string">&quot;https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png&quot;</span></span></span><br><span class="line"><span class="javascript">        &#125;,</span></span><br><span class="line"><span class="javascript">        <span class="attr">blogs</span>: &#123;&#125;,</span></span><br><span class="line"><span class="javascript">        <span class="attr">currentPage</span>: <span class="number">1</span>,</span></span><br><span class="line"><span class="javascript">        <span class="attr">total</span>: <span class="number">0</span></span></span><br><span class="line"><span class="javascript">      &#125;</span></span><br><span class="line"><span class="javascript">    &#125;,</span></span><br><span class="line"><span class="javascript">    <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">logout</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">const</span> _this = <span class="built_in">this</span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">this</span>.$axios.get(<span class="string">&#x27;http://localhost:8081/logout&#x27;</span>, &#123;</span></span><br><span class="line"><span class="javascript">          <span class="attr">headers</span>: &#123;</span></span><br><span class="line"><span class="javascript">            <span class="string">&quot;Authorization&quot;</span>: <span class="built_in">localStorage</span>.getItem(<span class="string">&quot;token&quot;</span>)</span></span><br><span class="line"><span class="javascript">          &#125;</span></span><br><span class="line"><span class="javascript">        &#125;).then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">          _this.$store.commit(<span class="string">&#x27;REMOVE_INFO&#x27;</span>)</span></span><br><span class="line"><span class="javascript">          _this.$router.push(<span class="string">&#x27;/login&#x27;</span>)</span></span><br><span class="line"><span class="javascript">        &#125;);</span></span><br><span class="line"><span class="javascript">      &#125;</span></span><br><span class="line"><span class="javascript">    &#125;,</span></span><br><span class="line"><span class="javascript">    <span class="function"><span class="title">created</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">if</span>(<span class="built_in">this</span>.$store.getters.getUser.username) &#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">this</span>.user.username = <span class="built_in">this</span>.$store.getters.getUser.username</span></span><br><span class="line"><span class="javascript">        <span class="built_in">this</span>.user.avatar = <span class="built_in">this</span>.$store.getters.getUser.avatar</span></span><br><span class="line"><span class="javascript">        <span class="built_in">this</span>.hasLogin = <span class="literal">true</span></span></span><br><span class="line"><span class="javascript">      &#125;</span></span><br><span class="line"><span class="javascript">    &#125;</span></span><br><span class="line"><span class="javascript">  &#125;</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç created()ä¸­åˆå§‹åŒ–ç”¨æˆ·çš„ä¿¡æ¯ï¼Œé€šè¿‡hasLoginçš„çŠ¶æ€æ¥æ§åˆ¶ç™»å½•å’Œé€€å‡ºæŒ‰é’®çš„åˆ‡æ¢ï¼Œä»¥åŠå‘è¡¨æ–‡ç« é“¾æ¥çš„disabledï¼Œè¿™æ ·ç”¨æˆ·çš„ä¿¡æ¯å°±èƒ½å±•ç¤ºå‡ºæ¥äº†ã€‚ ç„¶åè¿™é‡Œæœ‰ä¸ªé€€å‡ºæŒ‰é’®ï¼Œåœ¨methodsä¸­æœ‰ä¸ªlogout()æ–¹æ³•ï¼Œé€»è¾‘æ¯”è¾ƒç®€å•ï¼Œç›´æ¥è®¿é—®/logoutï¼Œå› ä¸ºä¹‹å‰axios.jsä¸­æˆ‘ä»¬å·²ç»è®¾ç½®axiosè¯·æ±‚çš„baseURLï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬ä¸å†éœ€è¦é“¾æ¥çš„å‰ç¼€äº†å“ˆã€‚å› ä¸ºæ˜¯ç™»å½•ä¹‹åæ‰èƒ½è®¿é—®çš„å—é™èµ„æºï¼Œæ‰€ä»¥åœ¨headerä¸­å¸¦ä¸Šäº†Authorizationã€‚è¿”å›ç»“æœæ¸…æ¥šstoreä¸­çš„ç”¨æˆ·ä¿¡æ¯å’Œtokenä¿¡æ¯ï¼Œè·³è½¬åˆ°ç™»å½•é¡µé¢ã€‚</p>
<p>ç„¶åéœ€è¦å¤´éƒ¨ç”¨æˆ·ä¿¡æ¯çš„é¡µé¢åªéœ€è¦å‡ ä¸ªæ­¥éª¤ï¼š</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import <span class="selector-tag">Header</span> <span class="selector-tag">from</span> &quot;@/components/Header&quot;;</span><br><span class="line">data() &#123;</span><br><span class="line">  components: &#123;Header&#125;</span><br><span class="line">&#125;</span><br><span class="line"># ç„¶åæ¨¡æ¿ä¸­è°ƒç”¨ç»„ä»¶</span><br><span class="line">&lt;<span class="selector-tag">Header</span>&gt;&lt;/<span class="selector-tag">Header</span>&gt;</span><br></pre></td></tr></table></figure>

<h4 id="åšå®¢åˆ†é¡µ"><a href="#åšå®¢åˆ†é¡µ" class="headerlink" title="åšå®¢åˆ†é¡µ"></a>åšå®¢åˆ†é¡µ</h4><p>æ¥ä¸‹æ¥å°±æ˜¯åˆ—è¡¨é¡µé¢ï¼Œéœ€è¦åšåˆ†é¡µï¼Œåˆ—è¡¨æˆ‘ä»¬åœ¨element-uiä¸­ç›´æ¥ä½¿ç”¨<strong>æ—¶é—´çº¿</strong>ç»„ä»¶æ¥ä½œä¸ºæˆ‘ä»¬çš„åˆ—è¡¨æ ·å¼ï¼Œè¿˜æ˜¯æŒºå¥½çœ‹çš„ã€‚è¿˜æœ‰æˆ‘ä»¬çš„åˆ†é¡µç»„ä»¶ã€‚</p>
<p>éœ€è¦å‡ éƒ¨åˆ†ä¿¡æ¯ï¼š</p>
<ul>
<li>åˆ†é¡µä¿¡æ¯</li>
<li>åšå®¢åˆ—è¡¨å†…å®¹ï¼ŒåŒ…æ‹¬idã€æ ‡é¢˜ã€æ‘˜è¦ã€åˆ›å»ºæ—¶é—´</li>
<li>views\Blogs.vue</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;<span class="selector-tag">div</span> class=&quot;m-container&quot;&gt;</span><br><span class="line">    &lt;<span class="selector-tag">Header</span>&gt;&lt;/<span class="selector-tag">Header</span>&gt;</span><br><span class="line">    &lt;<span class="selector-tag">div</span> class=&quot;block&quot;&gt;</span><br><span class="line">      &lt;el-timeline&gt;</span><br><span class="line">        &lt;el-timeline-item v-bind:timestamp=<span class="string">&quot;blog.created&quot;</span> placement=<span class="string">&quot;top&quot;</span> v-for=<span class="string">&quot;blog in blogs&quot;</span>&gt;</span><br><span class="line">          &lt;el-card&gt;</span><br><span class="line">            &lt;h4&gt;&lt;router-link :to=<span class="string">&quot;&#123;name: &#x27;BlogDetail&#x27;, params: &#123;blogId: blog.id&#125;&#125;&quot;</span>&gt;&#123;&#123;blog.title&#125;&#125;&lt;/router-link&gt;&lt;/<span class="selector-tag">h4</span>&gt;</span><br><span class="line">            &lt;<span class="selector-tag">p</span>&gt;&#123;&#123;blog<span class="selector-class">.description</span>&#125;&#125;&lt;/<span class="selector-tag">p</span>&gt;</span><br><span class="line">          &lt;/el-card&gt;</span><br><span class="line">        &lt;/el-timeline-item&gt;</span><br><span class="line">      &lt;/el-timeline&gt;</span><br><span class="line">     </span><br><span class="line">    &lt;/<span class="selector-tag">div</span>&gt;</span><br><span class="line">    &lt;el-pagination class=&quot;mpage&quot;</span><br><span class="line">      <span class="attribute">background</span></span><br><span class="line">      layout=&quot;prev, pager, next&quot;</span><br><span class="line">      <span class="selector-pseudo">:current</span>-page=currentPage</span><br><span class="line">      :page-size=pageSize</span><br><span class="line">      @current-change=page</span><br><span class="line">      :total=<span class="string">&quot;total&quot;</span>&gt;</span><br><span class="line">    &lt;/el-pagination&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">  import Header from <span class="string">&quot;@/components/Header&quot;</span>;</span><br><span class="line">  export default &#123;</span><br><span class="line">    name: <span class="string">&quot;Blogs&quot;</span>,</span><br><span class="line">    components: &#123;Header&#125;,</span><br><span class="line">    data() &#123;</span><br><span class="line">      return &#123;</span><br><span class="line">        blogs: &#123;&#125;,</span><br><span class="line">        currentPage: <span class="number">1</span>,</span><br><span class="line">        total: <span class="number">0</span>,</span><br><span class="line">        pageSize: <span class="number">5</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">      <span class="built_in">page</span>(currentPage) &#123;</span><br><span class="line">        const _this = this</span><br><span class="line">        this.$axios.<span class="built_in">get</span>(<span class="string">&#x27;http://localhost:8081/blogs?currentPage=&#x27;</span> + currentPage).<span class="built_in">then</span>((res) =&gt; &#123;</span><br><span class="line">          console.<span class="built_in">log</span>(res.data.data.records)</span><br><span class="line">          _this.blogs = res.data.data.records</span><br><span class="line">          _this.currentPage = res.data.data.current</span><br><span class="line">          _this.total = res.data.data.total</span><br><span class="line">          _this.pageSize = res.data.data.size</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    mounted () &#123;</span><br><span class="line">      this<span class="selector-class">.page</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>data()ä¸­ç›´æ¥å®šä¹‰åšå®¢åˆ—è¡¨blogsã€ä»¥åŠä¸€äº›åˆ†é¡µä¿¡æ¯ã€‚methods()ä¸­å®šä¹‰åˆ†é¡µçš„è°ƒç”¨æ¥å£pageï¼ˆcurrentPageï¼‰ï¼Œå‚æ•°æ˜¯éœ€è¦è°ƒæ•´çš„é¡µç currentPageï¼Œå¾—åˆ°ç»“æœä¹‹åç›´æ¥èµ‹å€¼å³å¯ã€‚ç„¶ååˆå§‹åŒ–æ—¶å€™ï¼Œç›´æ¥åœ¨mounted()æ–¹æ³•ä¸­è°ƒç”¨ç¬¬ä¸€é¡µthis.page(1)ã€‚å®Œç¾ã€‚ä½¿ç”¨element-uiç»„ä»¶å°±æ˜¯ç®€å•å¿«æ·å“ˆå“ˆï¼ æ³¨æ„æ ‡é¢˜è¿™é‡Œæˆ‘ä»¬æ·»åŠ äº†é“¾æ¥ï¼Œä½¿ç”¨çš„æ˜¯æ ‡ç­¾ã€‚</p>
<h3 id="10ã€åšå®¢ç¼–è¾‘ï¼ˆå‘è¡¨ï¼‰"><a href="#10ã€åšå®¢ç¼–è¾‘ï¼ˆå‘è¡¨ï¼‰" class="headerlink" title="10ã€åšå®¢ç¼–è¾‘ï¼ˆå‘è¡¨ï¼‰"></a>10ã€åšå®¢ç¼–è¾‘ï¼ˆå‘è¡¨ï¼‰</h3><p>æˆ‘ä»¬ç‚¹å‡»å‘è¡¨åšå®¢é“¾æ¥è°ƒæ•´åˆ°/blog/addé¡µé¢ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦ç”¨åˆ°ä¸€ä¸ªmarkdownç¼–è¾‘å™¨ï¼Œåœ¨vueç»„ä»¶ä¸­ï¼Œæ¯”è¾ƒå¥½ç”¨çš„æ˜¯mavon-editorï¼Œé‚£ä¹ˆæˆ‘ä»¬ç›´æ¥ä½¿ç”¨å“ˆã€‚å…ˆæ¥å®‰è£…mavon-editorç›¸å…³ç»„ä»¶ï¼š</p>
<h4 id="å®‰è£…mavon-editor"><a href="#å®‰è£…mavon-editor" class="headerlink" title="å®‰è£…mavon-editor"></a>å®‰è£…mavon-editor</h4><p>åŸºäºVueçš„markdownç¼–è¾‘å™¨mavon-editor</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm install mavon-editor --save</span><br></pre></td></tr></table></figure>

<p>ç„¶ååœ¨main.jsä¸­å…¨å±€æ³¨å†Œï¼š</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// å…¨å±€æ³¨å†Œ</span><br><span class="line">import Vue <span class="selector-tag">from</span> &#x27;vue&#x27;</span><br><span class="line">import mavonEditor <span class="selector-tag">from</span> &#x27;mavon-editor&#x27;</span><br><span class="line">import &#x27;mavon-editor/dist/css/index<span class="selector-class">.css</span>&#x27;</span><br><span class="line">// use</span><br><span class="line">Vue<span class="selector-class">.use</span>(mavonEditor)</span><br></pre></td></tr></table></figure>

<p>okï¼Œé‚£ä¹ˆæˆ‘ä»¬å»å®šä¹‰æˆ‘ä»¬çš„åšå®¢è¡¨å•ï¼š</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;<span class="selector-tag">div</span> class=&quot;m-container&quot;&gt;</span><br><span class="line">    &lt;<span class="selector-tag">Header</span>&gt;&lt;/<span class="selector-tag">Header</span>&gt;</span><br><span class="line">    &lt;<span class="selector-tag">div</span> class=&quot;m-<span class="attribute">content</span>&quot;&gt;</span><br><span class="line">      &lt;el-<span class="selector-tag">form</span> ref=&quot;editForm&quot; status-<span class="attribute">icon</span> :model=<span class="string">&quot;editForm&quot;</span> :rules=<span class="string">&quot;rules&quot;</span> label-width=<span class="string">&quot;80px&quot;</span>&gt;</span><br><span class="line">        &lt;el-form-item label=<span class="string">&quot;æ ‡é¢˜&quot;</span> prop=<span class="string">&quot;title&quot;</span>&gt;</span><br><span class="line">          &lt;el-input v-model=<span class="string">&quot;editForm.title&quot;</span>&gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=<span class="string">&quot;æ‘˜è¦&quot;</span> prop=<span class="string">&quot;description&quot;</span>&gt;</span><br><span class="line">          &lt;el-input type=<span class="string">&quot;textarea&quot;</span> v-model=<span class="string">&quot;editForm.description&quot;</span>&gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=<span class="string">&quot;å†…å®¹&quot;</span> prop=<span class="string">&quot;content&quot;</span>&gt;</span><br><span class="line">          &lt;mavon-editor v-model=<span class="string">&quot;editForm.content&quot;</span>/&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item&gt;</span><br><span class="line">          &lt;el-button type=<span class="string">&quot;primary&quot;</span> @click=<span class="string">&quot;submitForm()&quot;</span>&gt;ç«‹å³åˆ›å»º&lt;/el-button&gt;</span><br><span class="line">          &lt;el-button&gt;å–æ¶ˆ&lt;/el-button&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">      &lt;/el-form&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">  import Header from <span class="string">&quot;@/components/Header&quot;</span>;</span><br><span class="line">  export default &#123;</span><br><span class="line">    name: <span class="string">&quot;BlogEdit&quot;</span>,</span><br><span class="line">    components: &#123;Header&#125;,</span><br><span class="line">    data() &#123;</span><br><span class="line">      return &#123;</span><br><span class="line">        editForm: &#123;</span><br><span class="line">          id: null,</span><br><span class="line">          title: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">          description: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">          content: <span class="string">&#x27;&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        rules: &#123;</span><br><span class="line">          title: [</span><br><span class="line">            &#123;required: true, message: <span class="string">&#x27;è¯·è¾“å…¥æ ‡é¢˜&#x27;</span>, trigger: <span class="string">&#x27;blur&#x27;</span>&#125;,</span><br><span class="line">            &#123;min: <span class="number">3</span>, max: <span class="number">50</span>, message: <span class="string">&#x27;é•¿åº¦åœ¨ 3 åˆ° 50 ä¸ªå­—ç¬¦&#x27;</span>, trigger: <span class="string">&#x27;blur&#x27;</span>&#125;</span><br><span class="line">          ],</span><br><span class="line">          description: [</span><br><span class="line">            &#123;required: true, message: <span class="string">&#x27;è¯·è¾“å…¥æ‘˜è¦&#x27;</span>, trigger: <span class="string">&#x27;blur&#x27;</span>&#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    created() &#123;</span><br><span class="line">      const blogId = this.$route<span class="selector-class">.params</span><span class="selector-class">.blogId</span></span><br><span class="line">      const _this = this</span><br><span class="line">      if(blogId) &#123;</span><br><span class="line">        this.$axios<span class="selector-class">.get</span>(&#x27;/blog/&#x27; + blogId)<span class="selector-class">.then</span>((res) =&gt; &#123;</span><br><span class="line">          const blog = res<span class="selector-class">.data</span><span class="selector-class">.data</span></span><br><span class="line">          _this<span class="selector-class">.editForm</span><span class="selector-class">.id</span> = blog<span class="selector-class">.id</span></span><br><span class="line">          _this<span class="selector-class">.editForm</span><span class="selector-class">.title</span> = blog<span class="selector-class">.title</span></span><br><span class="line">          _this<span class="selector-class">.editForm</span><span class="selector-class">.description</span> = blog<span class="selector-class">.description</span></span><br><span class="line">          _this<span class="selector-class">.editForm</span><span class="selector-class">.content</span> = blog<span class="selector-class">.content</span></span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">      <span class="built_in">submitForm</span>() &#123;</span><br><span class="line">        const _this = this</span><br><span class="line">        this.$refs.editForm.<span class="built_in">validate</span>((valid) =&gt; &#123;</span><br><span class="line">          if (valid) &#123;</span><br><span class="line">            this.$axios.<span class="built_in">post</span>(<span class="string">&#x27;/blog/edit&#x27;</span>, this.editForm, &#123;</span><br><span class="line">              headers: &#123;</span><br><span class="line">                <span class="string">&quot;Authorization&quot;</span>: localStorage.<span class="built_in">getItem</span>(<span class="string">&quot;token&quot;</span>)</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;)<span class="selector-class">.then</span>((res) =&gt; &#123;</span><br><span class="line">              _this.$alert(&#x27;æ“ä½œæˆåŠŸ&#x27;, &#x27;æç¤º&#x27;, &#123;</span><br><span class="line">                confirmButtonText: <span class="string">&#x27;ç¡®å®š&#x27;</span>,</span><br><span class="line">                callback: action =&gt; &#123;</span><br><span class="line">                  _this.$router.<span class="built_in">push</span>(<span class="string">&quot;/blogs&quot;</span>)</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;);</span><br><span class="line">            &#125;);</span><br><span class="line">          &#125; else &#123;</span><br><span class="line">            console<span class="selector-class">.log</span>(&#x27;error submit!!&#x27;);</span><br><span class="line">            return false;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>é€»è¾‘ä¾ç„¶ç®€å•ï¼Œæ ¡éªŒè¡¨å•ï¼Œç„¶åç‚¹å‡»æŒ‰é’®æäº¤è¡¨å•ï¼Œæ³¨æ„å¤´éƒ¨åŠ ä¸ŠAuthorizationä¿¡æ¯ï¼Œè¿”å›ç»“æœå¼¹çª—æç¤ºæ“ä½œæˆåŠŸï¼Œç„¶åè·³è½¬åˆ°åšå®¢åˆ—è¡¨é¡µé¢ã€‚emmï¼Œå’Œå†™ajaxæ²¡å•¥åŒºåˆ«ã€‚ç†Ÿæ‚‰ä¸€ä¸‹vueçš„ä¸€äº›æŒ‡ä»¤ä½¿ç”¨å³å¯ã€‚ ç„¶åå› ä¸ºç¼–è¾‘å’Œæ·»åŠ æ˜¯åŒä¸€ä¸ªé¡µé¢ï¼Œæ‰€ä»¥æœ‰äº†create()æ–¹æ³•ï¼Œæ¯”å¦‚ä»ç¼–è¾‘è¿æ¥/blog/7/editä¸­è·å–blogIdä¸º7çš„è¿™ä¸ªidã€‚ç„¶åå›æ˜¾åšå®¢ä¿¡æ¯ã€‚è·å–æ–¹å¼æ˜¯const blogId = this.$route.params.blogIdã€‚</p>
<p>å¯¹äº†ï¼Œmavon-editorå› ä¸ºå·²ç»å…¨å±€æ³¨å†Œï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥ä½¿ç”¨ç»„ä»¶å³å¯ï¼š</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;mavon-editor v-model=&quot;editForm<span class="selector-class">.content</span>&quot;/&gt;</span><br></pre></td></tr></table></figure>

<p>æ•ˆæœå¦‚ä¸‹ï¼š </p>
<img src="%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae9cb783513" alt="å›¾ç‰‡" style="zoom:67%;" / loading="lazy">



<h3 id="11ã€åšå®¢è¯¦æƒ…"><a href="#11ã€åšå®¢è¯¦æƒ…" class="headerlink" title="11ã€åšå®¢è¯¦æƒ…"></a>11ã€åšå®¢è¯¦æƒ…</h3><p>åšå®¢è¯¦æƒ…ä¸­éœ€è¦å›æ˜¾åšå®¢ä¿¡æ¯ï¼Œç„¶åæœ‰ä¸ªé—®é¢˜å°±æ˜¯ï¼Œåç«¯ä¼ è¿‡æ¥çš„æ˜¯åšå®¢å†…å®¹æ˜¯markdownæ ¼å¼çš„å†…å®¹ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œæ¸²æŸ“ç„¶åæ˜¾ç¤ºå‡ºæ¥ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªæ’ä»¶markdown-itï¼Œç”¨äºè§£æmdæ–‡æ¡£ï¼Œç„¶åå¯¼å…¥github-markdown-cï¼Œæ‰€è°“mdçš„æ ·å¼ã€‚</p>
<p>æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç”¨äºè§£æmdæ–‡æ¡£</span></span><br><span class="line"><span class="attr">cnpm</span> <span class="string">install markdown-it --save</span></span><br><span class="line"><span class="comment"># mdæ ·å¼</span></span><br><span class="line"><span class="attr">cnpm</span> <span class="string">install github-markdown-css</span></span><br></pre></td></tr></table></figure>

<p>ç„¶åå°±å¯ä»¥åœ¨éœ€è¦æ¸²æŸ“çš„åœ°æ–¹ä½¿ç”¨ï¼š</p>
<ul>
<li>views\BlogDetail.vue</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;<span class="selector-tag">div</span> class=&quot;m-container&quot;&gt;</span><br><span class="line">    &lt;<span class="selector-tag">Header</span>&gt;&lt;/<span class="selector-tag">Header</span>&gt;</span><br><span class="line">    &lt;<span class="selector-tag">div</span> class=&quot;mblog&quot;&gt;</span><br><span class="line">      &lt;<span class="selector-tag">h2</span>&gt;&#123;&#123; blog<span class="selector-class">.title</span> &#125;&#125;&lt;/<span class="selector-tag">h2</span>&gt;</span><br><span class="line">      &lt;el-link <span class="attribute">icon</span>=&quot;el-<span class="attribute">icon</span>-edit&quot; v-if=&quot;ownBlog&quot;&gt;&lt;router-link :to=<span class="string">&quot;&#123;name: &#x27;BlogEdit&#x27;, params: &#123;blogId: blog.id&#125;&#125;&quot;</span>&gt;ç¼–è¾‘&lt;/router-link&gt;&lt;/el-link&gt;</span><br><span class="line">      &lt;el-divider&gt;&lt;/el-divider&gt;</span><br><span class="line">      &lt;div class=<span class="string">&quot;content markdown-body&quot;</span> v-html=<span class="string">&quot;blog.content&quot;</span>&gt;&lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">  import <span class="string">&#x27;github-markdown-css/github-markdown.css&#x27;</span> // ç„¶åæ·»åŠ æ ·å¼markdown-body</span><br><span class="line">  import Header from <span class="string">&quot;@/components/Header&quot;</span>;</span><br><span class="line">  export default &#123;</span><br><span class="line">    name: <span class="string">&quot;BlogDetail&quot;</span>,</span><br><span class="line">    components: &#123;</span><br><span class="line">      Header</span><br><span class="line">    &#125;,</span><br><span class="line">    data() &#123;</span><br><span class="line">      return &#123;</span><br><span class="line">        blog: &#123;</span><br><span class="line">          userId: null,</span><br><span class="line">          title: <span class="string">&quot;&quot;</span>,</span><br><span class="line">          description: <span class="string">&quot;&quot;</span>,</span><br><span class="line">          content: <span class="string">&quot;&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        ownBlog: false</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">      <span class="built_in">getBlog</span>() &#123;</span><br><span class="line">        const blogId = this.$route.params.blogId</span><br><span class="line">        const _this = this</span><br><span class="line">        this.$axios.<span class="built_in">get</span>(<span class="string">&#x27;/blog/&#x27;</span> + blogId).<span class="built_in">then</span>((res) =&gt; &#123;</span><br><span class="line">          console.<span class="built_in">log</span>(res)</span><br><span class="line">          console.<span class="built_in">log</span>(res.data.data)</span><br><span class="line">          _this.blog = res.data.data</span><br><span class="line">          var MarkdownIt = <span class="built_in">require</span>(<span class="string">&#x27;markdown-it&#x27;</span>),</span><br><span class="line">            md = new <span class="built_in">MarkdownIt</span>();</span><br><span class="line">          <span class="selector-tag">var</span> result = md<span class="selector-class">.render</span>(_this<span class="selector-class">.blog</span><span class="selector-class">.content</span>);</span><br><span class="line">          _this<span class="selector-class">.blog</span><span class="selector-class">.content</span> = result</span><br><span class="line">          // åˆ¤æ–­æ˜¯å¦æ˜¯è‡ªå·±çš„æ–‡ç« ï¼Œèƒ½å¦ç¼–è¾‘</span><br><span class="line">          _this<span class="selector-class">.ownBlog</span> =  (_this<span class="selector-class">.blog</span><span class="selector-class">.userId</span> === _this.$store<span class="selector-class">.getters</span><span class="selector-class">.getUser</span><span class="selector-class">.id</span>)</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    created() &#123;</span><br><span class="line">      this<span class="selector-class">.getBlog</span>()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>å…·ä½“é€»è¾‘è¿˜æ˜¯æŒºç®€å•ï¼Œåˆå§‹åŒ–create()æ–¹æ³•ä¸­è°ƒç”¨getBlog()æ–¹æ³•ï¼Œè¯·æ±‚åšå®¢è¯¦æƒ…æ¥å£ï¼Œè¿”å›çš„åšå®¢è¯¦æƒ…contenté€šè¿‡markdown-itå·¥å…·è¿›è¡Œæ¸²æŸ“ã€‚</p>
<p>å†å¯¼å…¥æ ·å¼ï¼š</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import &#x27;github-markdown<span class="selector-class">.css</span>&#x27;</span><br></pre></td></tr></table></figure>

<p>ç„¶ååœ¨contentçš„divä¸­æ·»åŠ classä¸ºmarkdown-bodyå³å¯å“ˆã€‚ æ•ˆæœå¦‚ä¸‹ï¼š</p>
<img src="%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB.assets/1725bae9d7e97e21" alt="å›¾ç‰‡" style="zoom: 50%;" / loading="lazy">



<p>å¦å¤–æ ‡é¢˜ä¸‹æ·»åŠ äº†ä¸ªå°å°çš„ç¼–è¾‘æŒ‰é’®ï¼Œé€šè¿‡ownBlog ï¼ˆåˆ¤æ–­åšæ–‡ä½œè€…ä¸ç™»å½•ç”¨æˆ·æ˜¯å¦åŒä¸€äººï¼‰æ¥åˆ¤æ–­æŒ‰é’®æ˜¯å¦æ˜¾ç¤ºå‡ºæ¥ã€‚</p>
<h3 id="12ã€è·¯ç”±æƒé™æ‹¦æˆª"><a href="#12ã€è·¯ç”±æƒé™æ‹¦æˆª" class="headerlink" title="12ã€è·¯ç”±æƒé™æ‹¦æˆª"></a>12ã€è·¯ç”±æƒé™æ‹¦æˆª</h3><p>é¡µé¢å·²ç»å¼€å‘å®Œæ¯•ä¹‹åï¼Œæˆ‘ä»¬æ¥æ§åˆ¶ä¸€ä¸‹å“ªäº›é¡µé¢æ˜¯éœ€è¦ç™»å½•ä¹‹åæ‰èƒ½è·³è½¬çš„ï¼Œå¦‚æœæœªç™»å½•è®¿é—®å°±ç›´æ¥é‡å®šå‘åˆ°ç™»å½•é¡µé¢ï¼Œå› æ­¤æˆ‘ä»¬åœ¨srcç›®å½•ä¸‹å®šä¹‰ä¸€ä¸ªjsæ–‡ä»¶ï¼š</p>
<ul>
<li>src\permission.js</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> router from <span class="string">&quot;./router&quot;</span>;</span><br><span class="line"><span class="comment">// è·¯ç”±åˆ¤æ–­ç™»å½• æ ¹æ®è·¯ç”±é…ç½®æ–‡ä»¶çš„å‚æ•°</span></span><br><span class="line">router.beforeEach((to, from, next) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (to.matched.some(record =&gt; record.meta.requireAuth)) &#123; <span class="comment">// åˆ¤æ–­è¯¥è·¯ç”±æ˜¯å¦éœ€è¦ç™»å½•æƒé™</span></span><br><span class="line">    <span class="keyword">const</span> token = localStorage.getItem(<span class="string">&quot;token&quot;</span>)</span><br><span class="line">    console.log(<span class="string">&quot;------------&quot;</span> + token)</span><br><span class="line">    <span class="keyword">if</span> (token) &#123; <span class="comment">// åˆ¤æ–­å½“å‰çš„tokenæ˜¯å¦å­˜åœ¨ ï¼› ç™»å½•å­˜å…¥çš„token</span></span><br><span class="line">      <span class="keyword">if</span> (to.path === <span class="string">&#x27;/login&#x27;</span>) &#123;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        next()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      next(&#123;</span><br><span class="line">        path: <span class="string">&#x27;/login&#x27;</span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    next()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡ä¹‹å‰æˆ‘ä»¬å†å®šä¹‰é¡µé¢è·¯ç”±æ—¶å€™çš„çš„metaä¿¡æ¯ï¼ŒæŒ‡å®šrequireAuth: trueï¼Œéœ€è¦ç™»å½•æ‰èƒ½è®¿é—®ï¼Œå› æ­¤è¿™é‡Œæˆ‘ä»¬åœ¨æ¯æ¬¡è·¯ç”±ä¹‹å‰ï¼ˆrouter.beforeEachï¼‰åˆ¤æ–­tokençš„çŠ¶æ€ï¼Œè§‰å¾—æ˜¯å¦éœ€è¦è·³è½¬åˆ°ç™»å½•é¡µé¢ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  path: <span class="string">&#x27;/blog/add&#x27;</span>, <span class="comment">// æ³¨æ„æ”¾åœ¨ path: &#x27;/blog/:blogId&#x27;ä¹‹å‰</span></span><br><span class="line">  name: <span class="string">&#x27;BlogAdd&#x27;</span>,</span><br><span class="line">  meta: &#123;</span><br><span class="line">    requireAuth: <span class="keyword">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  component: BlogEdit</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç„¶åæˆ‘ä»¬å†main.jsä¸­importæˆ‘ä»¬çš„permission.js</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./permission.js&#x27;</span> <span class="comment">// è·¯ç”±æ‹¦æˆª</span></span><br></pre></td></tr></table></figure>

<h3 id="13ã€å‰ç«¯æ€»ç»“"><a href="#13ã€å‰ç«¯æ€»ç»“" class="headerlink" title="13ã€å‰ç«¯æ€»ç»“"></a>13ã€å‰ç«¯æ€»ç»“</h3><p>okï¼ŒåŸºæœ¬æ‰€æœ‰é¡µé¢å°±å·²ç»å¼€å‘å®Œæ¯•å•¦ï¼Œcssæ ·å¼ä¿¡æ¯æˆ‘æœªè´´å‡ºæ¥ï¼Œå¤§å®¶ç›´æ¥ä¸Šgithubä¸Šcloneä¸‹æ¥æŸ¥çœ‹ã€‚</p>
<p>ä½œè€…ï¼šMarkerHubé“¾æ¥ï¼š<a target="_blank" rel="noopener" href="https://juejin.im/post/5ecfca676fb9a04793456fb8%E6%9D%A5%E6%BA%90%EF%BC%9A%E6%8E%98%E9%87%91%E8%91%97%E4%BD%9C%E6%9D%83%E5%BD%92%E4%BD%9C%E8%80%85%E6%89%80%E6%9C%89%E3%80%82%E5%95%86%E4%B8%9A%E8%BD%AC%E8%BD%BD%E8%AF%B7%E8%81%94%E7%B3%BB%E4%BD%9C%E8%80%85%E8%8E%B7%E5%BE%97%E6%8E%88%E6%9D%83%EF%BC%8C%E9%9D%9E%E5%95%86%E4%B8%9A%E8%BD%AC%E8%BD%BD%E8%AF%B7%E6%B3%A8%E6%98%8E%E5%87%BA%E5%A4%84%E3%80%82">https://juejin.im/post/5ecfca676fb9a04793456fb8æ¥æºï¼šæ˜é‡‘è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</a></p>
</div><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="Donate" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-hand-coin-line"></use></svg></span><div id="reward-comment">I'm so cute. Please give me money.</div><div id="qr" style="display:none;"><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://i.loli.net/2021/07/27/kcALMgvjIFhKVfH.jpg"><img loading="lazy" src="https://i.loli.net/2021/07/27/kcALMgvjIFhKVfH.jpg" alt="æ”¯ä»˜å®" title="æ”¯ä»˜å®"></a><div><span style="color:#00A3EE"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-alipay-line"></use></svg></span></div></div><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://i.loli.net/2021/07/27/oI5KPrjHLt7iOme.jpg"><img loading="lazy" src="https://i.loli.net/2021/07/27/oI5KPrjHLt7iOme.jpg" alt="QQ æ”¯ä»˜" title="QQ æ”¯ä»˜"></a><div><span style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></span></div></div><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://i.loli.net/2021/07/27/PCJNbqAlHpGWKEV.jpg"><img loading="lazy" src="https://i.loli.net/2021/07/27/PCJNbqAlHpGWKEV.jpg" alt="å¾®ä¿¡æ”¯ä»˜" title="å¾®ä¿¡æ”¯ä»˜"></a><div><span style="color:#2DC100"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-pay-line"></use></svg></span></div></div></div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>Post author: </strong>John Doe</li><li class="post-copyright-link"><strong>Post link: </strong><a href="http://example.com/2021/07/28/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/" title="">http://example.com/2021/07/28/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/</a></li><li class="post-copyright-license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> unless otherwise stated.</li></ul></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2021/07/28/%E9%A1%B9%E7%9B%AE%E8%A7%84%E5%88%99/" rel="prev" title=""><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-left-s-line"></use></svg><span class="post-nav-text"></span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2021/07/28/Vue/" rel="next" title=""><span class="post-nav-text"></span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>è¦ä¸è¦å’Œæˆ‘è¯´äº›ä»€ä¹ˆï¼Ÿ</span><br></div></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2019 â€“ 2021 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> John Doe</span></div><div class="powered"><span>Powered by <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> v5.4.0</span><span class="footer-separator">|</span><span>Theme - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.6.1</span></div><div class="live_time"><span>æœ¬åšå®¢å·²èŒèŒå“’åœ°è¿è¡Œ</span><span id="display_live_time"></span><span class="moe-text">(â—'â—¡'â—)</span><script>function blog_live_time() {
  setTimeout(blog_live_time, 1000);
  const start = new Date('2021-06-17T00:00:00');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = " " + passDay + " å¤© " + passHour + " å°æ—¶ " + passMinute + " åˆ† " + passSecond + " ç§’";
}
blog_live_time();
</script></div></footer><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a></div></body></html>